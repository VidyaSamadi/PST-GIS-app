// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on dojo/keys dijit/focus dojo/query jimu/dijit/CheckBox jimu/dijit/DropMenu jimu/dijit/LoadingShelter jimu/utils ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html dojo/dom-class dojo/dom-style ./NlsStrings".split(" "),function(u,q,e,h,n,a,d,l,k,g,t,r,f,A,B,w,C,x,z,c){return q([u,w],{templateString:C,_currentSelectedLayerRowNode:null,
operationsDropMenu:null,_layerNodeHandles:null,_layerDomNodeStorage:null,_firstLayerNode:!1,_lastLayerNode:!1,_eventHandlers:null,_layerIndexs:null,postMixInProperties:function(){this.inherited(arguments);this.nls=c.value;this._layerDomNodeStorage={};this._eventHandlers=[];this._initLayerIndexs()},postCreate:function(){this.refresh();this._initOperations()},_initLayerIndexs:function(){var b=2;this._layerIndexs={};this.operLayerInfos.traversalAll(e.hitch(this,function(p){this._layerIndexs[p.id]=b++}))},
refresh:function(){this._removeLayerNodes();h.forEach(this.operLayerInfos.getLayerInfoArray(),function(b){this.drawListNode(b,0,this.layerListTable)},this);this.config.showBasemap&&h.forEach(this.operLayerInfos.getBasemapLayerInfoArray(),function(b){this.drawListNode(b,0,this.layerListTable)},this);h.forEach(this.operLayerInfos.getTableInfoArray(),function(b){this.drawListNode(b,0,this.tableListTable)},this);h.forEach(this._eventHandlers,function(b){b.remove&&b.remove()});this._supports508Accessibility()},
drawListNode:function(b,p,c,d){var m;!this.isLayerHiddenInWidget(b)&&this.layerFilter.isValidLayerInfo(b)&&(m=this._layerDomNodeStorage[b.getObjectId()],(b.isRootLayer()||b.isTable)&&m?(a.place(m.layerTrNode,c,d),a.place(m.layerContentTrNode,c,d)):0===b.newSubLayers.length?(m=this.addLayerNode(b,p,c,d),this.config.showLegend?this.addLegendNode(b,p,m.subNode):(b=g(".showLegend-div",m.layerTrNode)[0])&&x.add(b,"hidden")):(m=this.addLayerNode(b,p,c,d),h.forEach(b.newSubLayers,e.hitch(this,function(b,
p){this.drawListNode(p,b+1,m.subNode)},p))))},addLayerNode:function(b,p,c,f){var m=this._layerIndexs[b.id],v,y,g,r,k,l,h=b.getRootLayerInfo();if(b.isRootLayer()||b.isTable)this._layerDomNodeStorage[b.getObjectId()]={layerTrNode:null,layerContentTrNode:null,layerNodeEventHandles:[],layerNodeReferredDijits:[]};v=a.create("tr",{"class":"jimu-widget-row layer-row layer-tr-node-"+b.id+"",tabindex:0,"aria-label":(b.isTable?window.jimuNls.common.table:window.jimuNls.common.layer)+" "+b.title,layerTrNodeId:b.id});
a.place(v,c,f);this._firstLayerNode||(this._firstLayerNode=v);this._lastLayerNode=v;y=a.create("td",{"class":"col col1"},v);for(g=0;g<p;g++)a.create("div",{"class":"begin-blank-div jimu-float-leading",innerHTML:""},y);l=a.create("div",{"class":"showLegend-div jimu-float-leading ",tabindex:m,role:"button","aria-label":this.nls.expandLayer,"aria-expanded":"false",imageShowLegendDivId:b.id},y);g=a.create("div",{"class":"div-select jimu-float-leading"},y);r=new t({checked:b.isVisible(),"class":"visible-checkbox-"+
b.id});a.place(r.domNode,g);n.setAttr(r.domNode,"tabindex",m);k=a.create("div",{"class":"noLegend-div jimu-float-leading"},y);var D;D=b.isTable?"images/table.png":b.isBasemap()?"images/basemap.png":"images/noLegend.png";a.create("img",{"class":"noLegend-image",src:this.layerListWidget.folderUrl+D,alt:"l"},k);if(b.isTiled||b.isTable||b.isBasemap())z.set(l,"display","none"),z.set(g,"display","none"),z.set(k,"display","block");z.set(y,"width",12*p+40+"px");p=a.create("td",{"class":"col col2"},v);y="";
try{b.isInScale()||(y="grayed-title")}catch(E){console.warn(E.message)}a.create("div",{innerHTML:b.title,"class":"layer-title-div-"+b.id+" div-content jimu-float-leading "+y},p);y=a.create("td",{"class":"col col3"},v);k=this.hasContentMenu()?"display: block":"display: none";m=a.create("div",{"class":"layers-list-popupMenu-div ",tabindex:m,role:"button","aria-haspopup":"true","aria-expanded":"false","aria-label":this.nls.tipLayerOperation,style:k},y);y=a.create("tr",{"class":"",layerContentTrNodeId:b.id});
a.place(y,c,f);c=a.create("td",{"class":"",colspan:"3"},y);c=a.create("table",{"class":"layer-sub-node",subNodeId:b.id},c);f=this.own(d(p,"click",e.hitch(this,this._onRowTrClick,b,l,v,c)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(l,"click",e.hitch(this,this._onRowTrClick,b,l,v,c)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(r.domNode,"click",e.hitch(this,this._onCkSelectNodeClick,b,r)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(m,"click",e.hitch(this,this._onPopupMenuClick,
b,m,v)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(v,"keydown",e.hitch(this,this._onLayerNodeKey,l,m)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(l,"keydown",e.hitch(this,this._onImageShowLegendKey,b,l,v,c,m)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(g,"keydown",e.hitch(this,this._onCkSelectDivKey,b,r,v)));this._storeLayerNodeEventHandle(h,f[0]);f=this.own(d(m,"keydown",e.hitch(this,this._onPopupMenuNodeKey,b,m,v,l)));this._storeLayerNodeEventHandle(h,f[0]);if(b.isRootLayer()||
b.isTable)this._layerDomNodeStorage[b.getObjectId()].layerTrNode=v,this._layerDomNodeStorage[b.getObjectId()].layerContentTrNode=y;this.layerFilter.isExpanded(b)&&this._foldOrUnfoldLayer(b,!1,l,c);return{layerTrNode:v,subNode:c}},hasContentMenu:function(){var b=!1,p;if(this.config.contextMenu)for(p in this.config.contextMenu)this.config.contextMenu.hasOwnProperty(p)&&"function"!==typeof this.config.contextMenu[p]&&(b=b||this.config.contextMenu[p]);else b=!0;return b},addLegendNode:function(b,p,c){c=
a.create("tr",{"class":"legend-node-tr"},c);c=a.create("td",{"class":"legend-node-td"},c);try{var y=b.createLegendsNode();z.set(y,"font-size",12*(p+1)+"px");a.place(y,c)}catch(m){console.error(m)}},redrawLegends:function(b){var p=g("div[legendsDivId\x3d'"+b.id+"']",this.layerListTable)[0];p&&(p._legendDijit&&p._legendDijit.destroy&&p._legendDijit.destroy(),b.drawLegends(p,this.layerListWidget.appConfig.portalUrl))},_storeLayerNodeEventHandle:function(b,p){(b=this._layerDomNodeStorage[b.getObjectId()])&&
b.layerNodeEventHandles.push(p)},_storeLayerNodeDijit:function(b,p){(b=this._layerDomNodeStorage[b.getObjectId()])&&b.layerNodeReferredDijits.push(p)},_clearLayerDomNodeStorage:function(){var b=this.operLayerInfos.getLayerInfoArray(),p=this.operLayerInfos.getTableInfoArray(),b=b.concat(p),c;for(c in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(c)&&"function"!==typeof this._layerDomNodeStorage[c]&&(p=h.some(b,function(b){if(b.getObjectId().toString()===c)return!0},this),p||(h.forEach(this._layerDomNodeStorage[c].layerNodeEventHandles,
function(b){b.remove()},this),h.forEach(this._layerDomNodeStorage[c].layerNodeReferredDijits,function(b){b.destroy()},this),a.destroy(this._layerDomNodeStorage[c].layerTrNode),a.destroy(this._layerDomNodeStorage[c].layerContentTrNode),delete this._layerDomNodeStorage[c]))},_removeLayerNodes:function(){var b,p;this._clearLayerDomNodeStorage();for(var c in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(c)&&"function"!==typeof this._layerDomNodeStorage[c]&&(b=this._layerDomNodeStorage[c],
b.layerContentTrNode&&b.layerTrNode&&((p=b.layerTrNode.parentNode)&&p.removeChild(b.layerTrNode),(p=b.layerContentTrNode.parentNode)&&p.removeChild(b.layerContentTrNode)))},_foldSwitch:function(b,p,c){return"none"===z.get(c,"display")?this._foldOrUnfoldLayer(b,!1,p,c):this._foldOrUnfoldLayer(b,!0,p,c)},_foldOrUnfoldLayer:function(b,p,c,a){var m=m?c:g("div[imageShowLegendDivId\x3d'"+b.id+"']",this.layerListTable)[0],v=v?a:g("table[subNodeId\x3d'"+b.id+"']",this.layerListTable)[0];c=null;m&&v&&(p?(z.set(v,
"display","none"),x.remove(m,"unfold"),c=!0,n.setAttr(m,"aria-label",this.nls.expandLayer),n.setAttr(m,"aria-expanded","false")):(z.set(v,"display","table"),x.add(m,"unfold"),c=!1,n.setAttr(m,"aria-label",this.nls.collapseLayer),n.setAttr(m,"aria-expanded","true"),b.isLeaf()&&(p=g(".legends-div",v)[0],m=g(".legends-loading-img",p)[0],p&&m&&b.drawLegends(p,this.layerListWidget.appConfig.portalUrl))));return c},_foldOrUnfoldLayers:function(b,p){h.forEach(b,function(b){this._foldOrUnfoldLayer(b,p)},
this)},_onCkSelectNodeClick:function(b,p,c){c.ctrlKey||c.metaKey?b.isRootLayer()?this.turnAllRootLayers(p.checked):this.turnAllSameLevelLayers(b,p.checked):(this.layerListWidget._denyLayerInfosIsVisibleChangedResponseOneTime=!0,b.setTopLayerVisible(p.checked));c.stopPropagation()},_onPopupMenuClick:function(b,p,c,a){var m=b.getRootLayerInfo(),v=p.popupMenu;if(!v){v=(new B({_layerInfo:b,box:this.layerListWidget.domNode.parentNode,popupMenuNode:p,layerListWidget:this.layerListWidget,_config:this.config})).placeAt(p);
p.popupMenu=v;this._storeLayerNodeDijit(m,v);var f=this.own(d(v,"onMenuClick",e.hitch(this,this._onPopupMenuItemClick,b,v)));this._storeLayerNodeEventHandle(m,f[0]);f=this.own(p.popupMenu.on("onOpenMenu",e.hitch(this,this._onPopupMenuOpen,b,p,m)));this._storeLayerNodeEventHandle(m,f[0])}this._changeSelectedLayerRow(c);v&&"opened"===v.state?v.closeDropMenu():(this._hideCurrentPopupMenu(),v&&(this.currentPopupMenu=v,v.openDropMenu()));this.operationsDropMenu&&"opened"===this.operationsDropMenu.state&&
this.operationsDropMenu.closeDropMenu();a.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&"opened"===this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerListWidgetPaneClick:function(){this.operationsDropMenu&&this.operationsDropMenu.closeDropMenu()},_onRowTrClick:function(b,p,c,a,m){this._changeSelectedLayerRow(c);p=this._foldSwitch(b,p,a);if(m.ctrlKey||m.metaKey)b.isRootLayer()?this.foldOrUnfoldAllRootLayers(p):this.foldOrUnfoldSameLevelLayers(b,
p)},_changeSelectedLayerRow:function(b){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===b||(this._currentSelectedLayerRowNode&&x.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),x.add(b,"jimu-widget-row-selected"),this._currentSelectedLayerRowNode=b)},_onPopupMenuItemClick:function(b,c,a,f){f={itemKey:a.key,extraData:f,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===a.key?"none"===z.get(c.transparencyDiv,"display")?c.showTransNode(b.getOpacity(),
a):c.hideTransNode():"setVisibilityRange"===a.key?"none"===z.get(c.setVisibilityRangeNode,"display")?c.showSetVisibilityRangeNode(b,a):c.hideSetVisibilityRangeNode():(b=c.popupMenuInfo.onPopupMenuClick(f),b.closeMenu&&c.closeDropMenu())},_exchangeLayerTrNode:function(b,c){b=g("tr[layerTrNodeId\x3d'"+b.id+"']",this.layerListTable)[0];var p=g("tr[layerTrNodeId\x3d'"+c.id+"']",this.layerListTable)[0];c=g("tr[layerContentTrNodeId\x3d'"+c.id+"']",this.layerListTable)[0];b&&p&&c&&(this.layerListTable.removeChild(p),
this.layerListTable.insertBefore(p,b),this.layerListTable.removeChild(c),this.layerListTable.insertBefore(c,b))},_getMovedSteps:function(b,c){var p=1,a,m=this.operLayerInfos.getLayerInfoArray();h.forEach(m,function(m,c){b.id===m.id&&(a=c)},this);if("moveup"===c)for(;!m[a].isFirst&&!(a--,!this.isLayerHiddenInWidget(m[a])&&this.layerFilter.isValidLayerInfo(m[a])||m[a].isFirst);)p++;else for(;!m[a].isLast&&!(a++,!this.isLayerHiddenInWidget(m[a])&&this.layerFilter.isValidLayerInfo(m[a])||m[a].isLast);)p++;
return p},moveUpLayer:function(b){var c=this._getMovedSteps(b,"moveup");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(c=this.operLayerInfos.moveUpLayer(b,c))&&this._exchangeLayerTrNode(c,b)},moveDownLayer:function(b){var c=this._getMovedSteps(b,"movedown");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(c=this.operLayerInfos.moveDownLayer(b,c))&&this._exchangeLayerTrNode(b,c)},isLayerHiddenInWidget:function(b){var c=!1,a=b;if(b&&this.config.layerOptions&&void 0!==this.config.layerOptions[b.id])for(;a&&
!(c=c||!this.config.layerOptions[a.id].display);)a=a.parentLayerInfo;else c=!1;return c},isFirstDisplayedLayerInfo:function(b){var c,a;b.isFirst||!b.isRootLayer()||b.isBasemap()?c=!0:(c=this._getMovedSteps(b,"moveup"),a=this.operLayerInfos.getLayerInfoArray(),b=this.operLayerInfos._getTopLayerInfoIndexById(b.id),c=this.isLayerHiddenInWidget(a[b-c])||!this.layerFilter.isValidLayerInfo(a[b-c])?!0:!1);return c},isLastDisplayedLayerInfo:function(b){var c,a;b.isLast||!b.isRootLayer()||b.isBasemap()?c=
!0:(c=this._getMovedSteps(b,"movedown"),a=this.operLayerInfos.getLayerInfoArray(),b=this.operLayerInfos._getTopLayerInfoIndexById(b.id),c=this.isLayerHiddenInWidget(a[b+c])||!this.layerFilter.isValidLayerInfo(a[b+c])?!0:!1);return c},_initOperations:function(){this.operationsDropMenu=(new r({items:[{key:"turnAllLayersOn",label:this.nls.turnAllLayersOn},{key:"turnAllLayersOff",label:this.nls.turnAllLayersOff},{key:"separator"},{key:"expandAllLayers",label:this.nls.expandAllLayers},{key:"collapseAlllayers",
label:this.nls.collapseAlllayers}],box:this.layerListWidget.domNode.parentNode})).placeAt(this.layerListOperations);var b=g("div.jimu-dropmenu \x3e div:first-child",this.layerListOperations)[0];b&&(x.remove(b,["jimu-icon-btn","popup-menu-button"]),x.add(b,["feature-action","icon-operation"]));this.operationsDropMenu.btnNode&&this.own(d(this.operationsDropMenu.btnNode,"click",e.hitch(this,this._onLayerListOperationsClick)));this.own(d(this.operationsDropMenu,"onMenuClick",e.hitch(this,this._onOperationsMenuItemClick)));
this.operationsDropMenuLoading=(new f({hidden:!0})).placeAt(this.operationsDropMenu.domNode);this.own(d(this.layerListOperations,"keydown",e.hitch(this,this._onLayerListOperationsKey)));this.own(d(this.operationsDropMenu,"onOpenMenu",e.hitch(this,this._onOperationsDropMenuOpen)))},_onLayerListOperationsClick:function(){this._hideCurrentPopupMenu()},_onOperationsMenuItemClick:function(b){switch(b.key){case "turnAllLayersOn":this.turnAllRootLayers(!0);break;case "turnAllLayersOff":this.turnAllRootLayers(!1);
break;case "expandAllLayers":this.foldOrUnfoldAllLayers(!1);break;case "collapseAlllayers":this.foldOrUnfoldAllLayers(!0)}},turnAllRootLayers:function(b){var c=this.operLayerInfos.getLayerInfoArray();h.forEach(c,function(c){this.isLayerHiddenInWidget(c)||c.setTopLayerVisible(b)},this)},turnAllSameLevelLayers:function(b,c){var a={},p=b.getRootLayerInfo();p.traversal(e.hitch(this,function(m){m.parentLayerInfo&&m.parentLayerInfo.id===b.parentLayerInfo.id&&!this.isLayerHiddenInWidget(m)?a[m.id]={visible:c}:
a[m.id]={visible:m.isVisible()}}));p.resetLayerObjectVisibility(a)},foldOrUnfoldAllRootLayers:function(b){var c=h.filter(this.operLayerInfos.getLayerInfoArray(),function(b){return!this.isLayerHiddenInWidget(b)},this);this._foldOrUnfoldLayers(c,b)},foldOrUnfoldSameLevelLayers:function(b,c){b.parentLayerInfo&&(b=h.filter(b.parentLayerInfo.getSubLayers(),function(b){return!this.isLayerHiddenInWidget(b)},this),this._foldOrUnfoldLayers(b,c))},foldOrUnfoldAllLayers:function(b){var c=[],a=[];this.operationsDropMenuLoading.show();
this.operLayerInfos.traversal(e.hitch(this,function(b){this.isLayerHiddenInWidget(b)||(b.isRootLayer()?a.push(b):c.push(b))}));var c=a.concat(c),f=0,m=c.length;setTimeout(e.hitch(this,function(){if(f<m){var a=c.slice(f,f+50);this._foldOrUnfoldLayers(a,b);f+=50;setTimeout(e.hitch(this,arguments.callee),60)}else this.operationsDropMenuLoading.hide()}),60)},_supports508Accessibility:function(){var b;this._lastLayerNode&&(b=d(this._lastLayerNode,"keydown",e.hitch(this,"_onLastLayerNodeKey")),this._eventHandlers.push(b),
A.initLastFocusNode(this.layerListWidget.domNode,this._lastLayerNode))},_onLastLayerNodeKey:function(b){b.keyCode===l.TAB&&(b.stopPropagation(),b.preventDefault(),k.focus(this.layerListWidget.layerFilter.searchButton))},_onLayerNodeKey:function(b,c,a){a.keyCode===l.ENTER&&(a.stopPropagation(),a.preventDefault(),"none"===n.getStyle(b,"display")?k.focus(c):k.focus(b))},_onImageShowLegendKey:function(b,c,a,f,m,v){v.keyCode===l.TAB&&v.stopPropagation();v.keyCode===l.TAB&&v.shiftKey?(v.stopPropagation(),
v.preventDefault(),k.focus(m)):v.keyCode===l.ESCAPE?(v.stopPropagation(),v.preventDefault(),k.focus(a)):v.keyCode===l.ENTER&&(v.stopPropagation(),v.preventDefault(),this._onRowTrClick(b,c,a,f,v))},_onCkSelectDivKey:function(b,c,a,f){f.keyCode===l.TAB&&f.stopPropagation();if(f.keyCode===l.ESCAPE)f.stopPropagation(),f.preventDefault(),k.focus(a);else if(f.keyCode===l.SPACE||f.keyCode===l.ENTER)f.stopPropagation(),f.preventDefault(),c.checked?c.uncheck(!0):c.check(!0),this._onCkSelectNodeClick(b,c,f)},
_onPopupMenuNodeKey:function(b,c,a,f,m){m.keyCode===l.TAB&&m.stopPropagation();if(m.keyCode===l.TAB&&!m.shiftKey)m.stopPropagation(),m.preventDefault(),k.focus(f);else if(m.keyCode===l.ESCAPE)m.stopPropagation(),m.preventDefault(),k.focus(a);else if(m.keyCode===l.ENTER||m.keyCode===l.DOWN_ARROW||m.keyCode===l.UP_ARROW)m.stopPropagation(),m.preventDefault(),this._onPopupMenuClick(b,c,a,m)},_onPopupMenuOpen:function(b,c,a){var f=g(".menu-item",c.popupMenu.dropMenuNode),f=f.filter(function(b){return n.hasClass(b,
"menu-item-hidden")?!1:!0}),m=f[0],v=f[f.length-1];f.forEach(function(b,p){var g=!1,r=!1,t=f[p-1],l=f[p+1];0===p?(k.focus(b),g=!0):p===f.length-1&&(r=!0);b.hasBeenOpened||(p=this.own(d(b,"keydown",e.hitch(this,this._onPopupMenuItemKey,c,t,l,m,v,g,r))),this._storeLayerNodeEventHandle(a,p[0]),b.hasBeenOpened=!0)},this)},_onPopupMenuItemKey:function(b,c,a,f,m,v,g,d){if(d.keyCode===l.DOWN_ARROW)d.stopPropagation(),d.preventDefault(),a&&k.focus(a);else if(d.keyCode===l.UP_ARROW)d.stopPropagation(),d.preventDefault(),
c&&k.focus(c);else if(d.keyCode===l.HOME)d.stopPropagation(),d.preventDefault(),f&&k.focus(f);else if(d.keyCode===l.END)d.stopPropagation(),d.preventDefault(),m&&k.focus(m);else if(d.keyCode===l.ESCAPE||d.keyCode===l.TAB)d.stopPropagation(),d.preventDefault(),k.focus(b),b.popupMenu.closeDropMenu()},_enableNavMode:function(b){b.keyCode!==l.TAB||A.isInNavMode()||n.addClass(document.body,"jimu-nav-mode")},_onLayerListOperationsKey:function(b){b.keyCode===l.ENTER&&this.operationsDropMenu._onBtnClick(b)},
_onOperationsDropMenuOpen:function(){var b=g(".menu-item",this.operationsDropMenu.domNode),b=b.filter(function(b){return n.hasClass(b,"menu-item-hidden")?!1:!0}),c=b[0],a=b[b.length-1];b.forEach(function(f,m){var v=!1,p=!1,g=b[m-1],r=b[m+1];0===m?(k.focus(f),v=!0):m===b.length-1&&(p=!0);f.hasBeenOpened||(this.own(d(f,"keydown",e.hitch(this,this._onLayerListOperationsMenuItemKey,g,r,c,a,v,p))),f.hasBeenOpened=!0)},this)},_onLayerListOperationsMenuItemKey:function(b,c,a,f,m,v,d){if(d.keyCode===l.DOWN_ARROW)d.stopPropagation(),
d.preventDefault(),c&&k.focus(c);else if(d.keyCode===l.UP_ARROW)d.stopPropagation(),d.preventDefault(),b&&k.focus(b);else if(d.keyCode===l.HOME)d.stopPropagation(),d.preventDefault(),a&&k.focus(a);else if(d.keyCode===l.END)d.stopPropagation(),d.preventDefault(),f&&k.focus(f);else if(d.keyCode===l.ESCAPE||d.keyCode===l.TAB)d.stopPropagation(),d.preventDefault(),k.focus(this.layerListOperations),this.operationsDropMenu.closeDropMenu()}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on dijit/focus dojo/keys dojo/Evented ../utils".split(" "),
function(u,q,e,h,n,a,d,l,k,g,t){return u([q,g],{baseClass:"jimu-dropmenu",declaredClass:"jimu.dijit.DropMenu",focusNodeWhenLeave:null,constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=n.create("div",{"class":"popup-menu-button"},this.domNode);this.own(d(this.btnNode,"click",e.hitch(this,this._onBtnClick)));this.box||(this.box=this.domNode.parentNode);this.own(d(this.box,"click",e.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(a){a.stopPropagation();
this.dropMenuNode||this._createDropMenuNode();"closed"===this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=n.create("div",{"class":"drop-menu",style:{display:"none"}},this.domNode);this.items||(this.items=[]);h.forEach(this.items,function(g){var f;g.key&&"separator"===g.key?n.create("hr",{"class":"menu-item-identification menu-item-line",itemId:g.key},this.dropMenuNode):g.key&&(f=n.create("div",{"class":"menu-item-identification menu-item",tabindex:"0",
itemId:g.key,role:"button",innerHTML:g.label},this.dropMenuNode),this.own(d(f,"click",e.hitch(this,function(a){this.selectItem(g,a)}))),this.own(d(f,"keydown",e.hitch(this,function(d){if(d.keyCode===k.ENTER){d.stopPropagation();d.preventDefault();var e=a("a",f)[0];e?(d=document.createEvent("MouseEvents"),d.initEvent("click",!0,!0),e.dispatchEvent(d)):this.selectItem(g,d)}}))))},this);this.focusNodeWhenLeave||(this.focusNodeWhenLeave=this.domNode.parentNode)},_getDropMenuPosition:function(){var a=
n.getContentBox(this.box),f=n.getMarginBox(this.domNode),d=n.getMarginBox(this.btnNode),g=n.getMarginBox(this.dropMenuNode),e={},k,t;e.l=f.l;e.t=f.t+d.h;e.t+g.h>a.h&&(t=f.t,k=a.h-f.t-d.h,k=Math.max(t,k),k===t&&(e.t=0-g.h));e.l+g.w>a.w&&(g=f.l,a=a.w-f.l-d.w,k=Math.max(g,a),k===g&&(e.l="",e.r=0));e.left=e.l;e.top=e.t;e.right=e.r;return e},getMenuItemNodeByItemKey:function(d){var f;a(".menu-item",this.dropMenuNode).some(function(a){return n.getAttr(a,"itemId")===d?(f=a,!0):!1},this);return f},selectItem:function(a){this.closeDropMenu();
this.emit("onMenuClick",a)},openDropMenu:function(){this.state="opened";n.setStyle(this.dropMenuNode,"display","");n.setStyle(this.dropMenuNode,t.getPositionStyle(this._getDropMenuPosition()));this.emit("onOpenMenu")},closeDropMenu:function(){"opened"===this.state&&l.focus(this.focusNodeWhenLeave);this.state="closed";n.setStyle(this.dropMenuNode,"display","none");this.emit("onCloseMenu")}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/on dojo/keys dijit/focus dojo/Deferred jimu/dijit/DropMenu jimu/utils dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style esri/dijit/VisibleScaleRangeSlider ./NlsStrings ./PopupMenuInfo".split(" "),
function(u,q,e,h,n,a,d,l,k,g,t,r,f,A,B,w,C,x,z){return u([g,r],{templateString:B,popupMenuInfo:null,loading:null,_deniedItems:null,_deniedItemsFromConfig:null,_layerInfo:null,constructor:function(){this.nls=x.value},postCreate:function(){this.inherited(arguments);this._initDeniedItems();this.loading=e.create("div",{"class":"popup-menu-loading"},this.popupMenuNode)},_initDeniedItems:function(){var c=[],b={ZoomTo:"zoomto",Transparency:"transparency",SetVisibilityRange:"setVisibilityRange",EnableOrDisablePopup:"controlPopup",
ControlLabels:"controlLabels",MoveupOrMovedown:"moveup movedown",OpenAttributeTable:"table",DescriptionOrShowItemDetailsOrDownload:"url"};this._deniedItems=[];this._deniedItemsFromConfig=[];for(var a in this._config.contextMenu)this._config.contextMenu.hasOwnProperty(a)&&"function"!==typeof this._config.contextMenu[a]&&!1===this._config.contextMenu[a]&&(c=c.concat(b[a].split(" ")));q.forEach(c,h.hitch(this,function(b){this._deniedItemsFromConfig.push({key:b,denyType:"hidden"})}))},_getDropMenuPosition:function(){return{top:"40px",
right:"0px",zIndex:1}},_getTransNodePosition:function(){return{top:"28px",right:"2px"}},_onBtnClick:function(){},_refresh:function(){this._denyItems();this._changeItemsUI()},_denyItems:function(){var c=n("[class~\x3d'menu-item-identification']",this.dropMenuNode);c.forEach(function(b){e.removeClass(b,"menu-item-dissable");e.removeClass(b,"menu-item-hidden")},this);e.removeClass(this.dropMenuNode,"no-border");q.forEach(this._deniedItems,function(b){var c=n("div[itemId\x3d'"+b.key+"']",this.dropMenuNode)[0];
c&&("disable"===b.denyType?(e.addClass(c,"menu-item-dissable"),"url"===b.key&&n(".menu-item-description",c).forEach(function(b){e.setAttr(b,"href","#");e.removeAttr(b,"target")})):e.addClass(c,"menu-item-hidden"))},this);for(var b=-1,a=0;a<c.length;a++)e.hasClass(c[a],"menu-item-line")&&(-1===b||e.hasClass(c[b],"menu-item-line"))&&e.addClass(c[a],"menu-item-hidden"),e.hasClass(c[a],"menu-item-hidden")||(b=a);c=q.filter(c,function(b){return!e.hasClass(b,"menu-item-hidden")});0===c.length?e.addClass(this.dropMenuNode,
"no-border"):(e.removeClass(this.dropMenuNode,"no-border"),e.hasClass(c[c.length-1],"menu-item-line")&&e.addClass(c[c.length-1],"menu-item-hidden"))},_changeItemsUI:function(){var c=n("[itemid\x3dcontrolPopup]",this.dropMenuNode)[0];c&&(this._layerInfo.isPopupNestedEnabled()?e.setAttr(c,"innerHTML",this.nls.removePopup):e.setAttr(c,"innerHTML",this.nls.enablePopup));(c=n("[itemid\x3dcontrolLabels]",this.dropMenuNode)[0])&&this._layerInfo.canShowLabel()&&(this._layerInfo.isShowLabels()?e.setAttr(c,
"innerHTML",this.nls.hideLables):e.setAttr(c,"innerHTML",this.nls.showLabels))},_switchLoadingState:function(c){c?e.setStyle(this.loading,"display","block"):e.setStyle(this.loading,"display","none")},selectItem:function(c,b){for(var a=!1,f=0;f<this._deniedItems.length;f++)if(this._deniedItems[f].key===c.key){a=!0;break}a||this.emit("onMenuClick",c);b.stopPropagation(b)},openDropMenu:function(){var c=h.hitch(this,this.inherited,arguments),b=new k;this._switchLoadingState(!0);this.dropMenuNode?b.resolve(this.popupMenuInfo):
z.create(this._layerInfo,this.layerListWidget).then(h.hitch(this,function(c){this.items=c.getDisplayItems();this.popupMenuInfo=c;this._createDropMenuNode();b.resolve(this.popupMenuInfo)}));b.then(h.hitch(this,function(){this.popupMenuInfo.getDeniedItems().then(h.hitch(this,function(b){this._deniedItems=this._deniedItemsFromConfig.concat(b);this._refresh();c(arguments);this._switchLoadingState(!1)}),h.hitch(this,function(){this._switchLoadingState(!1)}))}),h.hitch(this,function(){this._switchLoadingState(!1)}))},
closeDropMenu:function(){this.inherited(arguments);this.hideTransNode();this.hideSetVisibilityRangeNode()},_onTransparencyDivClick:function(c){c.stopPropagation()},showTransNode:function(c,b){this.hideSetVisibilityRangeNode();this.transHorizSlider||(this._createTransparencyWidget(b),this.transHorizSlider.set("value",1-c));w.set(this.transparencyDiv,"top",this._getTransNodePosition().top);isRTL?w.set(this.transparencyDiv,"left",this._getTransNodePosition().right):w.set(this.transparencyDiv,"right",
this._getTransNodePosition().right);w.set(this.transparencyDiv,"display","block");this.transHorizSlider.focus()},hideTransNode:function(){w.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(c){this.transHorizSlider=new f({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",h.hitch(this,function(b){this.emit("onMenuClick",{key:"transparencyChanged"},{newTransValue:b})})));this.own(a(this.transHorizSlider.domNode,
"keydown",h.hitch(this,function(b){b.keyCode===d.ESCAPE?(b.stopPropagation(),b.preventDefault(),this.hideTransNode(),(b=this.getMenuItemNodeByItemKey(c.key))&&l.focus(b)):b.keyCode===d.TAB&&(b.stopPropagation(),b.preventDefault(),this._enableNavMode(b))})));new A({container:"bottomDecoration"},this.transparencyRule)},_onSetVisibilityRangeNode:function(c){c.stopPropagation()},showSetVisibilityRangeNode:function(c,b){this.hideTransNode();if(!this.visibleScaleRangeSlider){var a=c.getScaleRange();this.visibleScaleRangeSlider=
(new C({map:c.map,minScale:a.minScale,maxScale:a.maxScale})).placeAt(this.setVisibilityRangeNode);this.visibleScaleRangeSlider.startup();this._supportsVisibilityRange508Accessibility(b)}this.own(this.visibleScaleRangeSlider.on("scale-range-change",h.hitch(this,function(b){c.setScaleRange(b.minScale,b.maxScale)})));w.set(this.setVisibilityRangeNode,"top",this._getTransNodePosition().top);isRTL?w.set(this.setVisibilityRangeNode,"left",this._getTransNodePosition().right):w.set(this.setVisibilityRangeNode,
"right",this._getTransNodePosition().right);w.set(this.setVisibilityRangeNode,"display","block");this.visibleScaleRangeSlider._slider.focus();this.visibleScaleRangeSlider._slider.focus()},hideSetVisibilityRangeNode:function(){w.set(this.setVisibilityRangeNode,"display","none")},hide:function(){w.set(this.domNode,"display","none")},show:function(){w.set(this.domNode,"display","block")},_enableNavMode:function(c){c.keyCode!==d.TAB||t.isInNavMode()||e.addClass(document.body,"jimu-nav-mode")},_supportsVisibilityRange508Accessibility:function(c){var b=
n(".dijitSliderImageHandle",this.setVisibilityRangeNode)[0],f=n(".dijitDownArrowButton",this.setVisibilityRangeNode),g=f[1],e=f[0],m=f[1];this.own(a(b,"keydown",h.hitch(this,function(b){b.keyCode===d.TAB&&b.shiftKey&&(b.stopPropagation(),b.preventDefault())})));this.own(a(g,"keydown",h.hitch(this,function(b){b.keyCode!==d.TAB||b.shiftKey?b.keyCode===d.ENTER&&(b.stopPropagation(),b.preventDefault(),setTimeout(h.hitch(this,function(){this._bindEsriScaleMenuPopupKey(m)}),200)):(b.stopPropagation(),b.preventDefault())})));
this.own(a(e,"keydown",h.hitch(this,function(b){b.keyCode===d.ENTER&&(b.stopPropagation(),b.preventDefault(),setTimeout(h.hitch(this,function(){this._bindEsriScaleMenuPopupKey(e)}),200))})));this.own(a(e,"click",h.hitch(this,function(b){b.stopPropagation();b.preventDefault();setTimeout(h.hitch(this,function(){this._bindEsriScaleMenuPopupKey(e)}),200)})));this.own(a(m,"click",h.hitch(this,function(b){b.stopPropagation();b.preventDefault();setTimeout(h.hitch(this,function(){this._bindEsriScaleMenuPopupKey(m)}),
200)})));this.own(a(this.setVisibilityRangeNode,"keydown",h.hitch(this,function(b){b.keyCode===d.ESCAPE?(b.stopPropagation(),b.preventDefault(),this.hideSetVisibilityRangeNode(),(b=this.getMenuItemNodeByItemKey(c.key))&&l.focus(b)):b.keyCode===d.TAB?(b.stopPropagation(),this._enableNavMode(b)):b.keyCode===d.ENTER&&b.stopPropagation()})))},_bindEsriScaleMenuPopupKey:function(c){var b=this._getEsriScaleMenuPopup(),f,g,k;b&&(f=n(".dijitInputInner",b)[0],e.setAttr(f,"tabindex","0"),g=n(".esriHeader",
b),k=n(".esriCurrent",b)[0],g[0]&&k&&e.setAttr(f,"aria-label",g[0].innerText+" "+k.innerText),l.focus(f));if(b&&!b._hasBeenBoundKey){var m=n(".esriContent",b)[1];e.setAttr(m,"tabindex","0");g[1]&&e.setAttr(m,"aria-label",g[1].innerText+" ");g=n("li.esriItem",b);q.forEach(g,function(f){e.setAttr(f,"tabindex","0");this.own(a(f,"keydown",h.hitch(this,function(a){var g=this._getMenuItemInfo(b,f);a.keyCode===d.TAB?(a.stopPropagation(),a.preventDefault(),m&&l.focus(m)):a.keyCode===d.DOWN_ARROW?(a.stopPropagation(),
a.preventDefault(),g.nextMenuItem&&l.focus(g.nextMenuItem)):a.keyCode===d.UP_ARROW?(a.stopPropagation(),a.preventDefault(),g.previousMenuItem&&l.focus(g.previousMenuItem)):a.keyCode===d.ESCAPE?(a.stopPropagation(),a.preventDefault(),m&&l.focus(m)):a.keyCode===d.ENTER&&(a.stopPropagation(),a.preventDefault(),a=document.createEvent("MouseEvents"),a.initEvent("click",!0,!0),f.dispatchEvent(a),c&&l.focus(c))})))},this);this.own(a(f,"keydown",h.hitch(this,function(b){b.keyCode===d.TAB?(b.stopPropagation(),
b.preventDefault(),this._enableNavMode(b),l.focus(m)):b.keyCode===d.ESCAPE?c&&l.focus(c):b.keyCode===d.ENTER&&c&&l.focus(c)})));m&&this.own(a(m,"keydown",h.hitch(this,function(a){var m=this._getMenuItemInfo(b);a.keyCode===d.TAB?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),l.focus(f)):a.keyCode===d.ENTER?(a.stopPropagation(),a.preventDefault(),m.firstMenuItem&&l.focus(m.firstMenuItem)):a.keyCode===d.ESCAPE&&c&&l.focus(c)})));b._hasBeenBoundKey=!0}},_getMenuItemInfo:function(c,b){var a=
{firstMenuItem:null,lastMenuItem:null,previousMenuItem:null,nextMenuItem:null},f=n("li.esriItem",c),f=q.filter(f,h.hitch(this,function(b){return e.hasClass(b,"esriHidden")?!1:!0}));b&&q.some(f,function(c,m){return c===b?(a.previousMenuItem=f[m-1],a.nextMenuItem=f[m+1],!0):!1},this);a.firstMenuItem=f[0];a.lastMenuItem=f[f.length-1];return a},_getEsriScaleMenuPopup:function(){var c=null;n(".esriScaleMenuPopup",document.body).some(function(b){return"block"===e.getStyle(b,"display")?(c=b,!0):!1});return c}})})},
"esri/dijit/VisibleScaleRangeSlider":function(){define("../kernel ./_EventedWidget ./_Tooltip ./VisibleScaleRangeSlider/_RecommendedScaleRangeBounds ./VisibleScaleRangeSlider/_SlideEvent ./VisibleScaleRangeSlider/ScaleMenu ./VisibleScaleRangeSlider/ScalePreview ./VisibleScaleRangeSlider/ScaleRanges dijit/form/DropDownButton dijit/popup dojo/_base/array dojo/_base/lang dojo/aspect dojo/debounce dojo/Deferred dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/on dojo/string dojox/form/HorizontalRangeSlider dojo/i18n!../nls/jsapi".split(" "),
function(u,q,e,h,n,a,d,l,k,g,t,r,f,A,B,w,C,x,z,c,b,p,y,D){q=q.createSubclass([e],{declaredClass:"esri.dijit.VisibleScaleRangeSlider",baseClass:"esriVisibleScaleRangeSlider",css:{currentScaleIndicator:"esriCurrentScaleIndicator",currentScaleIndicatorContainer:"esriCurrentScaleIndicatorContainer",scaleIndicator:"esriScaleIndicator",scaleIndicatorContainer:"esriScaleIndicatorContainer"},disabled:!1,map:null,layer:null,region:"en-US",minScale:0,maxScale:0,intermediateChanges:!1,labels:D.widgets.visibleScaleRangeSlider,
_slider:null,_currentScaleIndicator:null,_scalePreview:null,_maxScaleButton:null,_minScaleButton:null,_mapUpdateHandler:null,_scaleRanges:null,_scheduleScaleRangeChangeEmit:null,_getSliderIndexRange:function(b){b=Math.floor(b);return{min:b,max:b+.99999}},_setDisabledAttr:function(b){this._slider.set("disabled",b);this._maxScaleButton.set("disabled",b);this._minScaleButton.set("disabled",b);this._set("disabled",b)},_setMapAttr:function(b){this._set("map",b);this._mapUpdateHandler&&this._mapUpdateHandler.remove();
this._slider.set("disabled",!0);this._ensureMap().then(this._updateFromMap)},_setConstraintsAttr:function(b){this._set("constraints",b);this._setUpSlider({minScale:b.minScale,maxScale:b.maxScale})},_updateFromMap:function(b){var c=b.getMinScale(),a=b.getMaxScale();this._setUpSlider({minScale:c,maxScale:a});this._updateCurrentScaleIndicator();b=b.on("zoom-end",r.hitch(this,this._updateCurrentScaleIndicator));this.own(b);this._mapUpdateHandler=b},_setUpSlider:function(b){var c=b.maxScale;b=b.minScale;
var a;this._slider.set("disabled",this.get("disabled"));this._scaleRanges.set("scaleRangeBounds",{minScale:b,maxScale:c});a=this._getSliderIndexRange(this._scaleRanges.length-1);this._slider.set("maximum",a.max);this._silentSliderUpdate({maxScale:c,minScale:b})},_ensureMap:function(){return this._untilLoaded(this.map)},_untilLoaded:function(b){var c=new B;if(b)if(b.loaded)c.resolve(b);else b.on("load",function(){c.resolve(b)});else c.reject(Error("could not load resource"));return c.promise},_updateCurrentScaleIndicator:function(){var b=
this._scaleRanges.clampScale(this.map.getScale()),b=this._mapScaleToSlider(b)/this._slider.maximum;this.isLeftToRight()||(b=1-b);z.set(this._currentScaleIndicator,{left:100*b+"%"})},_setLayerAttr:function(b){this._set("layer",b);this._ensureScaleRangeProvider().then(this._ensureLayer).then(this._updateMinMaxScaleFromLayer)},_ensureLayer:function(){return this._untilLoaded(this.layer)},_updateMinMaxScaleFromLayer:function(b){this.set({minScale:b.minScale,maxScale:b.maxScale})},_mapSliderToScale:function(b){var c=
this._getSliderIndexRange(b),a=this._scaleRanges.findScaleRangeByIndex(b);return this._mapToRange(b,c.min,c.max,a.minScale,a.maxScale)},_mapToRange:function(b,c,a,f,d){return f+(b-c)*(d-f)/(a-c)},_setRegionAttr:function(b){this._set("region",b);this._scalePreview.set("source",l.getScalePreviewSource(b))},_getMinimumAttr:function(){return this._mapSliderToScale(this._slider.minimum)},_getMaximumAttr:function(){return this._mapSliderToScale(this._slider.maximum)},_getActualMaxScaleAttr:function(){return this._scaleRanges.clampMaxScale(this.maxScale)},
_setMaxScaleAttr:function(b){this._set("maxScale",b);this._ensureScaleRangeProvider().then(r.hitch(this,function(){b=this._scaleRanges.clampMaxScale(b);this._set("maxScale",this._layerConstrainedMaxScale(b));this._silentSliderUpdate({maxScale:b});this._scheduleScaleRangeChangeEmit()}))},_silentSliderUpdate:function(b){var c=b.minScale,a=b.maxScale,f=this._scaleRanges;b=this._slider;void 0!==c&&(c=this._mapScaleToSlider(f.clampMinScale(c)),b.set("value",c,!1,!1));void 0!==a&&(c=this._mapScaleToSlider(f.clampMaxScale(a)),
b.set("value",c,!1,!0))},_mapScaleToSlider:function(b){var c=this._scaleRanges.scaleToRangeIndex(b),a=this._getSliderIndexRange(c),c=this._scaleRanges.findScaleRangeByIndex(c);return this._mapToRange(b,c.minScale,c.maxScale,a.min,a.max)},_getActualMinScaleAttr:function(){return this._scaleRanges.clampMinScale(this.minScale)},_setMinScaleAttr:function(b){this._set("minScale",b);this._ensureScaleRangeProvider().then(r.hitch(this,function(){b=this._scaleRanges.clampMinScale(b);this._set("minScale",this._layerConstrainedMinScale(b));
this._silentSliderUpdate({minScale:b});this._scheduleScaleRangeChangeEmit()}))},_ensureScaleRangeProvider:function(){if(this.map)return this._ensureMap();var b=new B;this.constraints&&b.resolve();return b.promise},_emitScaleRangeChange:function(){this.emit("scale-range-change",{minScale:this.minScale,maxScale:this.maxScale})},_layerConstrainedMinScale:function(b){var c=r.getObject("tileInfo.lods",!1,this.layer)||[],a;return 0<c.length?(c=c[0].scale,a=this._scaleRanges.get("firstRange"),(a=.85<this._mapToRange(b,
a.maxScale,a.minScale,0,1))?c:b>c?c:b):this._scaleRanges.beyondMinScale(b)?0:b},_layerConstrainedMaxScale:function(b){var c=r.getObject("tileInfo.lods",!1,this.layer)||[];return 0<c.length?(c=c[c.length-1].scale,b<c?c:b):this._scaleRanges.beyondMaxScale(b)?0:b},constructor:function(){this._scaleRanges=new (l.createSubclass([h]));this._scheduleScaleRangeChangeEmit=A(r.hitch(this,this._emitScaleRangeChange),0);this._ensureMap=r.hitch(this,this._ensureMap);this._ensureScaleRangeProvider=r.hitch(this,
this._ensureScaleRangeProvider);this._ensureLayer=r.hitch(this,this._ensureLayer);this._updateMinMaxScaleFromLayer=r.hitch(this,this._updateMinMaxScaleFromLayer);this._updateFromMap=r.hitch(this,this._updateFromMap)},buildRendering:function(){this.inherited(arguments);this._initSlider();this._initScalePreview();this._initCurrentScaleIndicator();this._initScaleMenus()},_initSlider:function(){var b=new (y.createSubclass([n]))({baseClass:"esriHorizontalSlider",showButtons:!1,intermediateChanges:this.intermediateChanges,
disabled:!0});this._slider=b;b.placeAt(this.domNode);b.startup();this.own(b.on("slide-onmousemove, slidemax-onmousemove",r.hitch(this,function(b){this._updateScalePreview(b.movable.handle)})),b.on("slide-onmovestop, slidemax-onmovestop",r.hitch(this,function(b){w.contains(b.movable.handle,"dijitSliderThumbHover")||this._closeScalePreview()})),b.on("change",r.hitch(this,function(){var b=Math.round(this._mapSliderToScale(this._getSliderMin())),c=Math.round(this._mapSliderToScale(this._getSliderMax()));
this.set({minScale:b,maxScale:c})})),f.after(b,"_setValueAttr",r.hitch(this,this._updateLabelMenus)))},_getSliderMin:function(){return this._slider.get("value")[0]},_getSliderMax:function(){return this._slider.get("value")[1]},_updateLabelMenus:function(){var b=this._maxScaleButton;this._minScaleButton.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMin()));b.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMax()))},_initScalePreview:function(){var b=new d;b.startup();
g.moveOffScreen(b);t.forEach([this._slider._movable.handle,this._slider._movableMax.handle],function(b){b.onmouseenter=r.hitch(this,this._updateScalePreview,b);b.onmouseleave=r.hitch(this,this._closeScalePreview)},this);this.own(b);this._scalePreview=b},_closeScalePreview:function(){g.close(this._scalePreview)},_updateScalePreview:function(b){if(!this.disabled){var c=this._scalePreview;g.moveOffScreen(c);var a=this._slider,f=b===a.sliderHandle?this._getSliderMin():this._getSliderMax(),d=x.position(b),
e=x.position(c.domNode),a=x.position(a.sliderBarContainer),m=this.isLeftToRight(),f=this._scaleRanges.getScalePreviewSpriteBackgroundPosition(f);c.set("backgroundPosition",f);d=d.x-a.x;e=.5*e.w;g.open({parent:this,popup:c,around:b,orient:d<e?m?["above","below"]:["above-alt","below-alt"]:d<a.w-e?["above-centered","below-centered"]:m?["above-alt","below-alt"]:["above","below"]})}},_initCurrentScaleIndicator:function(){if(this.map){var c=C.create("div",{className:this.css.scaleIndicatorContainer+" "+
this.css.currentScaleIndicatorContainer},this._slider.sliderBarContainer),a=C.create("div",{className:this.css.scaleIndicator+" "+this.css.currentScaleIndicator},c);this._currentScaleIndicator=a;this.createTooltip(a);c=b(a,"mouseover",r.hitch(this,function(){var b=p.substitute(this.labels.currentScaleTooltip,{scaleLabel:this._scaleRanges.getScaleRangeLabel(this._mapScaleToSlider(this.map.getScale()))});this.findTooltip(a).set("label",b)}));this.own(c)}},_initScaleMenus:function(){var b=new a,c=new a,
d,g;this.own(b.on("scale-selected",r.hitch(this,function(b){d.closeDropDown();this.set("minScale",b.scale)})));this.own(c.on("scale-selected",r.hitch(this,function(b){g.closeDropDown();this.set("maxScale",b.scale)})));d=new k({baseClass:"esriScaleMenuButton esriMinScaleMenuButton",dropDown:b,dropDownPosition:["below","above"]});d.toggleDropDown();d.toggleDropDown();g=new k({baseClass:"esriScaleMenuButton esriMaxScaleMenuButton",dropDown:c,dropDownPosition:["below","above"]});g.toggleDropDown();g.toggleDropDown();
this.own(f.before(d,"openDropDown",r.hitch(this,function(){var c=this._scaleRanges.findScaleRange(this.get("actualMaxScale")).minScale;b.set("options",{label:d.label,scale:{current:this.get("actualMinScale"),map:this._getMapScale(),min:this.get("minimum"),max:c}})})));this.own(f.before(g,"openDropDown",r.hitch(this,function(){var b=this._scaleRanges.findScaleRange(this.get("actualMinScale")).maxScale;c.set("options",{label:g.label,scale:{current:this.get("actualMaxScale"),map:this._getMapScale(),
min:b,max:this.get("maximum")}})})));d.placeAt(this.domNode);g.placeAt(this.domNode);b.startup();c.startup();d.startup();g.startup();this._minScaleButton=d;this._maxScaleButton=g},_getMapScale:function(){return this.map?this.map.getScale():-1},startup:function(){this.inherited(arguments);this.watch("intermediateChanges",function(b,c,a){this._slider.set(b,a)})}});c("extend-esri")&&r.setObject("dijit.VisibleScaleRangeSlider",q,u);return q})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip",
"dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(u,q,e,h,n){return e(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);this._started||q.forEach(this._tooltips,function(a){a.startup()})},destroy:function(){this.inherited(arguments);q.forEach(this._tooltips,function(a){a.destroy()});this._tooltips=null},createTooltips:function(a){q.forEach(a,function(a){this.createTooltip(a.node,
a.label)},this)},createTooltip:function(a,d){if(a=this._getConnectId(a))d="object"===typeof d?h.mixin({},d,{connectId:a}):{connectId:a,label:d},d=new u(d),this._started&&d.startup(),this._tooltips.push(d)},_getConnectId:function(a){var d,e;if(a){if(h.isArray(a)){if(d=[],q.forEach(a,function(a){(e=this._getNode(a))&&d.push(e)}),0===d.length)return}else if(d=this._getNode(a),!d)return;return d}},_getNode:function(a){return n.byId(a.domNode||a)},findTooltip:function(a){var d=this._getNode(a),e,k,g;if(a){a=
this._tooltips;e=a.length;for(var t=0;t<e;t++)if(k=a[t],g=h.isArray(k.connectId)?-1<q.indexOf(k.connectId,d):k.connectId===d)return k}}})})},"esri/dijit/VisibleScaleRangeSlider/_RecommendedScaleRangeBounds":function(){define(["./recommendedScales","dojo/_base/declare"],function(u,q){return q(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._RecommendedScaleRangeBounds",beyondMinScale:function(e){var h=this.get("firstRange"),n=h.minScale,h=u.getRecommendedScale(h.id)||h.maxScale;return e<=n&&
e>h},beyondMaxScale:function(e){var h=this.get("lastRange"),n=h.maxScale,h=u.getRecommendedScale(h.id)||h.minScale;return e<h&&e>=n}})})},"esri/dijit/VisibleScaleRangeSlider/recommendedScales":function(){define(["dojo/_base/lang"],function(u){var q={_recommendedScales:{world:1E8,continent:5E7,countriesBig:25E6,countriesSmall:12E6,statesProvinces:6E6,stateProvince:3E6,counties:15E5,county:75E4,metropolitanArea:32E4,cities:16E4,city:8E4,town:4E4,neighborhood:2E4,streets:1E4,street:5E3,buildings:2500,
building:1250,smallBuilding:800,rooms:400,room:100},getRecommendedScale:function(e){return q._recommendedScales[e]},all:function(){return u.clone(q._recommendedScales)}};return q})},"esri/dijit/VisibleScaleRangeSlider/_SlideEvent":function(){define(["dojo/_base/array","dojo/_base/declare"],function(u,q){return q(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._SlideEvent",_events:["onMouseMove","onFirstMove",{name:"onMoveStop",hookTo:"destroy"}],postCreate:function(){this.inherited(arguments);
this._extendMover(this._movable);this._extendMover(this._movableBar,"rangebar");this._extendMover(this._movableMax,"max")},_extendMover:function(e,h){if(e){var n=e.mover,a={};u.forEach(this._events,function(d){var l,k,g,t,r,f;"object"===typeof d?(k=d.name,l=d.hookTo):k=d;g=n.prototype[k]||function(){};t="slide"+(h||"")+"-"+k.toLowerCase();r=function(){g.apply(this,arguments);this.widget.emit(t,{movable:e})};l&&(f=n.prototype[l],a[l]=function(){f.apply(this,arguments);r.apply(this,arguments)});a[k]=
r});n.extend(a)}}})})},"esri/dijit/VisibleScaleRangeSlider/ScaleMenu":function(){define("../../kernel ../_EventedWidget ../_Tooltip ./recommendedScales ./ScaleRanges dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-prop dojo/dom-style dojo/has dojo/keys dojo/number dojo/on dojo/query dojo/string dojox/html/entities dojox/lang/functional/object dojo/i18n!../../nls/jsapi dojo/text!./templates/ScaleMenu.html dijit/form/TextBox".split(" "),
function(u,q,e,h,n,a,d,l,k,g,t,r,f,A,B,w,C,x,z,c,b,p,y,D){q=l([q,a,d,e],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScaleMenu",templateString:D,baseClass:"esriScaleMenu",labels:y.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",section:"esriSection",content:"esriContent",current:"esriCurrent",input:"esriInput",list:"esriList",item:"esriItem",inline:"esriInline",selectable:"esriSelectable",hidden:"esriHidden"},_elementValueMap:null,_elements:null,_scaleRangeCategories:null,_scaleRanges:null,
_rangeToScaleAndNodeLookup:null,constructor:function(){this._scaleRanges=new n},buildRendering:function(){this.inherited(arguments);this._rangeToScaleAndNodeLookup={map:{scale:null,node:this.dap_mapScaleItem}};var b=this.labels,a=b.featuredScaleLabels,d=h.all(),g=this.css.item+" "+this.css.selectable,e;k.forEach(p.keys(d),function(b){e=a[b];var f=d[b],k=c.substitute(e,{scaleLabel:this._formatScale(f)}),k=r.create("li",{innerHTML:k,className:g},this.dap_recommendedScales);this._rangeToScaleAndNodeLookup[b]=
{scale:f,node:k}},this);var t=r.create("span",{innerHTML:b.setTo,className:this.css.inline}),l=r.create("span",{innerHTML:b.selectOne,className:this.css.inline});f.set(this.dap_scaleListHeader,"innerHTML",c.substitute(b.setToSelectOne,{setTo:t.outerHTML,selectOne:l.outerHTML}))},_formatScale:function(b){return"1:"+C.format(b)},postCreate:function(){this.inherited(arguments);this.own(x(this.domNode,x.selector("."+this.css.item+"."+this.css.selectable,"click"),g.hitch(this,function(b){b=b.target===
this.dap_mapScaleItem?this.options.scale.map:this._parseScale(b.target.innerHTML);this._emitScaleSelected(b)})));this.dap_scaleInput.on("keyDown",g.hitch(this,function(b){b.keyCode===w.ENTER&&this._handleCustomScaleInput()}));this.createTooltip(this.dap_scaleInput,this.labels.customScaleInputTooltip)},_emitScaleSelected:function(b){this.emit("scale-selected",{scale:b})},_handleCustomScaleInput:function(){var b=this._parseScale(this.dap_scaleInput.get("value"));isNaN(b)||this._emitScaleSelected(this._scaleRanges.clampScale(b))},
_parseScale:function(c){c=b.decode(c).replace(/.*\(/,"").replace(/\).*$/,"").replace(/.*1:/,"").replace(/[^0-9.\s]/g,"");return C.parse(c)},_setOptionsAttr:function(b){var a=b.scale,d=this._formatScale(a.current);f.set(this.dap_currentScaleLabel,"innerHTML",b.label);this.dap_scaleInput.set("value",d,!1);d=c.substitute(this.labels.featuredScaleLabels.current,{scaleLabel:this._formatScale(a.map)});this._rangeToScaleAndNodeLookup.map.scale=a.map;f.set(this.dap_mapScaleItem,"innerHTML",d);t.toggle(this.dap_mapScaleItem,
this.css.hidden,-1===a.map);this._scaleRanges.set("scaleRangeBounds",{minScale:a.min,maxScale:a.max});this._hideOutOfScaleRanges();this._set("options",b)},_hideOutOfScaleRanges:function(){var b=z("."+this.css.item+"."+this.css.selectable,this.dap_recommendedScales),c=this._scaleRanges;k.forEach(p.keys(this._rangeToScaleAndNodeLookup),function(b){b=this._rangeToScaleAndNodeLookup[b];t.toggle(b.node,this.css.hidden,!c.contains(b.scale))},this);b=b.every(function(b){return"none"===A.get(b,"display")});
t.toggle(this.dap_recommendedScaleSection,this.css.hidden,b)}});B("extend-esri")&&g.setObject("dijit.ScaleMenu",q,u);return q})},"esri/dijit/VisibleScaleRangeSlider/ScaleRanges":function(){define(["./scalePreviewUtil","dojo/_base/array","dojo/_base/declare","dojo/Stateful","dojo/i18n!../../nls/jsapi"],function(u,q,e,h,n){e=e(h,{_scaleRangeStops:[{id:"room",minScale:100},{id:"rooms",minScale:400},{id:"smallBuilding",minScale:800},{id:"building",minScale:1999},{id:"buildings",minScale:3999},{id:"street",
minScale:7499},{id:"streets",minScale:14999},{id:"neighborhood",minScale:29999},{id:"town",minScale:59999},{id:"city",minScale:119999},{id:"cities",minScale:249999},{id:"metropolitanArea",minScale:499999},{id:"county",minScale:999999},{id:"counties",minScale:1999999},{id:"state",minScale:3999999},{id:"states",minScale:6999999},{id:"country",minScale:14999999},{id:"countries",minScale:34999999},{id:"continent",minScale:99999999},{id:"world",minScale:147914382}],_allRanges:null,_ranges:null,length:0,
constructor:function(){this._allRanges=this.getScaleRanges()},_scaleRangeBoundsSetter:function(a){this._ranges=a=this.getScaleRanges(a.maxScale,a.minScale);this.length=a.length},getScaleRanges:function(a,d){var e=this._scaleRangeStops,k=e.length,g,t,r;a=0<=a?a:0;d=0<d?d:e[k-1].minScale;g=a;t=[];for(var f=0;f<k;f++){var h=Math.min(e[f].minScale,d);r=Math.min(h,d);a<=h&&g<d&&t.push({id:e[f].id,maxScale:Math.max(g,a),minScale:r});g=r+1}t.reverse();return this._ensureValidBoundaryRanges(t)},_ensureValidBoundaryRanges:function(a){var d=
a[0];d.minScale===d.maxScale&&(a.shift(),a[0].minScale+=1);d=a[a.length-1];d.minScale===d.maxScale&&(a.pop(),--a[a.length-1].maxScale);return a},getScalePreviewSpriteBackgroundPosition:function(a){a=this._toFullRangeIndex(a);return u.getScalePreviewSpriteBackgroundPosition(a)},_toFullRangeIndex:function(a){a=this.findScaleRangeByIndex(Math.floor(a));for(var d=this._allRanges,e=d.length,k=0,g=0;g<e;g++)if(d[g].id===a.id){k=g;break}return k},getScaleRangeLabel:function(a){a=this._ranges[this._clampScaleRangeIndex(a)];
return n.widgets.visibleScaleRangeSlider.scaleRangeLabels[a.id]},findScaleRange:function(a){var d=this._ranges,e,k;if(a>=d[0].maxScale)return d[0];if(a<=d[d.length-1].minScale)return d[d.length-1];for(var g=0;g<d.length;g++)if(k=d[g],a>=k.maxScale&&a<=k.minScale){e=k;break}return e},findScaleRangeByIndex:function(a){a=this._clampScaleRangeIndex(a);return this._ranges[a]},clampScale:function(a){return Math.min(this.get("minScale"),Math.max(this.get("maxScale"),a))},_minScaleGetter:function(){return this.get("firstRange").minScale},
_maxScaleGetter:function(){return this.get("lastRange").maxScale},_firstRangeGetter:function(){return this._ranges[0]},_lastRangeGetter:function(){var a=this._ranges;return a[a.length-1]},clampMinScale:function(a){return 0===a?this.get("minScale"):this.clampScale(a)},clampMaxScale:function(a){return this.clampScale(a)},_clampScaleRangeIndex:function(a){if(0>=a)return 0;var d=this._ranges.length-1;return a>d?d:Math.floor(a)},scaleToRangeIndex:function(a){return q.indexOf(this._ranges,this.findScaleRange(a))},
contains:function(a){for(var d=this._ranges,e=!1,k,g=0;g<d.length;g++)if(k=d[g],a>=k.maxScale&&a<=k.minScale){e=!0;break}return e}});e.getScalePreviewSource=function(a){return u.getScalePreviewSource(a)};return e})},"esri/dijit/VisibleScaleRangeSlider/scalePreviewUtil":function(){define(["dojo/_base/array","require"],function(u,q){var e={_supportedRegions:"ar-iq ar-kw bg-bg cs-cz da-dk da-gl da-gl de-at de-ch de-de de-li el-gr en-ae en-au en-ca en-ca en-eg en-gb en-hk en-id en-ie en-ie en-il en-in en-iq en-ke en-lu en-mo en-my en-nz en-rw en-sg en-us en-us en-vi en-vi en-wo en-za es-ar es-ar es-bo es-bo es-cl es-cl es-co es-co es-cr es-cr es-es es-gt es-gt es-mx es-mx es-ni es-ni es-pe es-pe es-pr es-pr es-sv es-sv es-ve et-ee fi-fi fi-fi fr-ci fr-fr fr-ma fr-mg fr-ml fr-tn is-is is-is it-it ja-jp ja-jp ko-kr lt-lt lv-lv nl-be nl-nl nl-sr nl-sr nn-no nn-no pl-pl pt-br pt-br pt-pt ro-ro ru-ru sk-sk sv-se sv-se th-th zh-cn zh-tw".split(" "),
_defaultRegion:"en-us",_getSupportedRegion:function(h){h=h?h.toLowerCase():"";return-1<u.indexOf(e._supportedRegions,h)?h:e._defaultRegion},getScalePreviewSource:function(h){h="./images/scalePreview/"+e._getSupportedRegion(h)+".jpg";return"url("+q.toUrl(h)+")"},getScalePreviewSpriteBackgroundPosition:function(e){return"-"+e%5*128+"px -"+128*Math.floor(e/5)+"px"}};return e})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(u,q,e){var h={};
q.mixin(e,{keys:function(e){var a=[],d;for(d in e)d in h||a.push(d);return a},values:function(e){var a=[],d;for(d in e)d in h||a.push(e[d]);return a},filterIn:function(n,a,d){d=d||u.global;a=e.lambda(a);var l={},k,g;for(g in n)g in h||(k=n[g],a.call(d,k,g,n)&&(l[g]=k));return l},forIn:function(n,a,d){d=d||u.global;a=e.lambda(a);for(var l in n)l in h||a.call(d,n[l],l,n);return d},mapIn:function(n,a,d){d=d||u.global;a=e.lambda(a);var l={},k;for(k in n)k in h||(l[k]=a.call(d,n[k],k,n));return l}});return e})},
"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(u,q,e){var h=q.getObject("lang.functional",!0,u),n={},a=1<"ab".split(/a*/).length?String.prototype.split:function(a){var d=this.split.call(this,a);(a=a.exec(this))&&0==a.index&&d.unshift("");return d},d=function(d){var g=[],t=a.call(d,/\s*->\s*/m);if(1<t.length)for(;t.length;)d=t.pop(),g=t.pop().split(/\s*,\s*|\s+/m),t.length&&t.push("(function("+g.join(", ")+"){ return ("+d+"); })");else if(d.match(/\b_\b/))g=
["_"];else{var t=d.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),k=d.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(t||k)t&&(g.push("$1"),d="$1"+d),k&&(g.push("$2"),d+="$2");else{var t=d.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[],f={};e.forEach(t,function(a){f.hasOwnProperty(a)||(g.push(a),f[a]=1)})}}return{args:g,body:d}},l=function(a){return a.length?function(){var d=a.length-1,e=h.lambda(a[d]).apply(this,arguments);for(--d;0<=d;--d)e=h.lambda(a[d]).call(this,e);return e}:function(a){return a}};q.mixin(h,{rawLambda:function(a){return d(a)},buildLambda:function(a){a=d(a);return"function("+a.args.join(",")+"){return ("+a.body+");}"},lambda:function(a){if("function"==typeof a)return a;
if(a instanceof Array)return l(a);if(n.hasOwnProperty(a))return n[a];var e=d(a);return n[a]=new Function(e.args,"return ("+e.body+");")},clearLambdaCache:function(){n={}}});return h})},"esri/dijit/VisibleScaleRangeSlider/ScalePreview":function(){define("../../kernel dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/ScalePreview.html".split(" "),function(u,q,e,h,n,a,d,l,k){q=h([e,q],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScalePreview",
baseClass:"esriScalePreview",templateString:k,labels:l.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",thumbnail:"esriThumbnail"},source:null,_setSourceAttr:function(d){this.source!==d&&(this._set("source",d),a.set(this.dap_scalePreviewThumbnail,"backgroundImage",d))},backgroundPosition:null,_setBackgroundPositionAttr:function(d){this.backgroundPosition!==d&&(this._set("backgroundPosition",d),a.set(this.dap_scalePreviewThumbnail,"backgroundPosition",d))}});d("extend-esri")&&n.setObject("dijit.ScalePreview",
q,u);return q})},"dojox/form/HorizontalRangeSlider":function(){define(["dojo/_base/declare","dojox/form/_RangeSliderMixin","dojo/text!./resources/HorizontalRangeSlider.html","dijit/form/HorizontalSlider"],function(u,q,e,h){return u("dojox.form.HorizontalRangeSlider",[h,q],{templateString:e})})},"dojox/form/_RangeSliderMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/_base/event dojo/_base/sniff dojo/dom-style dojo/dom-geometry dojo/keys dijit dojo/dnd/Mover dojo/dnd/Moveable dijit/form/_FormValueWidget dijit/focus dojo/fx dojox/fx".split(" "),
function(u,q,e,h,n,a,d,l,k,g,t,r,f,A,B){var w=function(a,c){return a-c};g=u("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments);this.value=e.map(this.value,function(a){return parseInt(a,10)})},postCreate:function(){this.inherited(arguments);this.value.sort(w);var a=this,c=u(C,{constructor:function(){this.widget=a}});this._movableMax=new r(this.sliderHandleMax,{mover:c});this.sliderHandle.setAttribute("aria-valuemin",
this.minimum);this.sliderHandle.setAttribute("aria-valuemax",this.maximum);this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum);this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);c=u(x,{constructor:function(){this.widget=a}});this._movableBar=new r(this.progressBar,{mover:c});this.focusNode.removeAttribute("aria-valuemin");this.focusNode.removeAttribute("aria-valuemax");this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments);this._movableMax.destroy();
this._movableBar.destroy()},_onKeyPress:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey)){var c=a.target===this.sliderHandleMax,b=a.target===this.progressBar,f=q.delegate(k,this.isLeftToRight()?{PREV_ARROW:k.LEFT_ARROW,NEXT_ARROW:k.RIGHT_ARROW}:{PREV_ARROW:k.RIGHT_ARROW,NEXT_ARROW:k.LEFT_ARROW}),d=0,e=!1;switch(a.keyCode){case f.HOME:this._setValueAttr(this.minimum,!0,c);n.stop(a);return;case f.END:this._setValueAttr(this.maximum,!0,c);n.stop(a);return;case f.PREV_ARROW:case f.DOWN_ARROW:e=
!0;case f.NEXT_ARROW:case f.UP_ARROW:d=1;break;case f.PAGE_DOWN:e=!0;case f.PAGE_UP:d=this.pageIncrement;break;default:this.inherited(arguments);return}e&&(d=-d);d&&(b?this._bumpValue([{change:d,useMaxValue:!1},{change:d,useMaxValue:!0}]):this._bumpValue(d,c),n.stop(a))}},_onHandleClickMax:function(f){this.disabled||this.readOnly||(a("ie")||A.focus(this.sliderHandleMax),n.stop(f))},_onClkIncBumper:function(){this._setValueAttr(!1===this._descending?this.minimum:this.maximum,!0,!0)},_bumpValue:function(a,
c){a=q.isArray(a)?[this._getBumpValue(a[0].change,a[0].useMaxValue),this._getBumpValue(a[1].change,a[1].useMaxValue)]:this._getBumpValue(a,c);this._setValueAttr(a,!0,c)},_getBumpValue:function(a,c){var b=c?1:0;c=d.getComputedStyle(this.sliderBarContainer);var f=l.getContentBox(this.sliderBarContainer,c);c=this.discreteValues;b=this.value[b];if(1>=c||Infinity==c)c=f[this._pixelCount];c--;a=this.maximum>this.minimum?(b-this.minimum)*c/(this.maximum-this.minimum)+a:0;0>a&&(a=0);a>c&&(a=c);return a*(this.maximum-
this.minimum)/c+this.minimum},_onBarClick:function(f){this.disabled||this.readOnly||(a("ie")||A.focus(this.progressBar),n.stop(f))},_onRemainingBarClick:function(f){if(!this.disabled&&!this.readOnly){a("ie")||A.focus(this.progressBar);var c=l.position(this.sliderBarContainer,!0),b=l.position(this.progressBar,!0),d=f[this._mousePixelCoord],e=b[this._startingPixelCoord],b=e+b[this._pixelCount],e=this._isReversed()?d<=e:d>=b,d=this._isReversed()?c[this._pixelCount]-d+c[this._startingPixelCoord]:d-c[this._startingPixelCoord];
this._setPixelValue(d,c[this._pixelCount],!0,e);n.stop(f)}},_setPixelValue:function(a,c,b,f){this.disabled||this.readOnly||(a=this._getValueByPixelValue(a,c),this._setValueAttr(a,b,f))},_getValueByPixelValue:function(a,c){var b=this.discreteValues;if(1>=b||Infinity==b)b=c;b--;return(this.maximum-this.minimum)*Math.round((0>a?0:c<a?c:a)/(c/b))/b+this.minimum},_setValueAttr:function(a,c,b){var d=q.clone(this.value);q.isArray(a)?d=a:d[b?1:0]=a;this._lastValueReported="";this.valueNode.value=a=d;d.sort(w);
this.sliderHandle.setAttribute("aria-valuenow",d[0]);this.sliderHandleMax.setAttribute("aria-valuenow",d[1]);f.prototype._setValueAttr.apply(this,arguments);this._printSliderBar(c,b)},_printSliderBar:function(a,c){c=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0;var b=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,f=c;c>b&&(c=b,b=f);var d=this._isReversed()?100*(1-c):100*c,e=this._isReversed()?100*(1-b):100*b,g=this._isReversed()?
100*(1-b):100*c;if(a&&0<this.slideDuration&&this.progressBar.style[this._progressPixelSize]){if(parseFloat(this.progressBar.style[this._handleOffsetCoord]),a=this.slideDuration/10,0!==a){0>a&&(a=0-a);var t={},r={},f={};t[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:d,units:"%"};r[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:e,units:"%"};f[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],
end:g,units:"%"};f[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(b-c),units:"%"};c=h.animateProperty({node:this.sliderHandle.parentNode,duration:a,properties:t});b=h.animateProperty({node:this.sliderHandleMax.parentNode,duration:a,properties:r});a=h.animateProperty({node:this.progressBar,duration:a,properties:f});B.combine([c,b,a]).play()}}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=d+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=
e+"%",this.progressBar.style[this._handleOffsetCoord]=g+"%",this.progressBar.style[this._progressPixelSize]=100*(b-c)+"%"}});var C=u("dijit.form._SliderMoverMax",t,{onMouseMove:function(a){var c=this.widget,b=c._abspos;b||(b=c._abspos=l.position(c.sliderBarContainer,!0),c._setPixelValue_=q.hitch(c,"_setPixelValue"),c._isReversed_=c._isReversed());a=a[c._mousePixelCoord]-b[c._startingPixelCoord];c._setPixelValue_(c._isReversed_?b[c._pixelCount]-a:a,b[c._pixelCount],!1,!0)},destroy:function(a){t.prototype.destroy.apply(this,
arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,!0)}}),x=u("dijit.form._SliderBarMover",t,{onMouseMove:function(a){var c=this.widget;if(!c.disabled&&!c.readOnly){var b=c._abspos,f=c._bar,d=c._mouseOffset;b||(b=c._abspos=l.position(c.sliderBarContainer,!0),c._setPixelValue_=q.hitch(c,"_setPixelValue"),c._getValueByPixelValue_=q.hitch(c,"_getValueByPixelValue"),c._isReversed_=c._isReversed());f||(f=c._bar=l.position(c.progressBar,!0));d||(d=c._mouseOffset=a[c._mousePixelCoord]-f[c._startingPixelCoord]);
a=a[c._mousePixelCoord]-b[c._startingPixelCoord]-d;pixelValues=[a,a+f[c._pixelCount]];pixelValues.sort(w);0>=pixelValues[0]&&(pixelValues[0]=0,pixelValues[1]=f[c._pixelCount]);pixelValues[1]>=b[c._pixelCount]&&(pixelValues[1]=b[c._pixelCount],pixelValues[0]=b[c._pixelCount]-f[c._pixelCount]);b=[c._getValueByPixelValue(c._isReversed_?b[c._pixelCount]-pixelValues[0]:pixelValues[0],b[c._pixelCount]),c._getValueByPixelValue(c._isReversed_?b[c._pixelCount]-pixelValues[1]:pixelValues[1],b[c._pixelCount])];
c._setValueAttr(b,!1,!1)}},destroy:function(){t.prototype.destroy.apply(this,arguments);var a=this.widget;a._abspos=null;a._bar=null;a._mouseOffset=null;a._setValueAttr(a.value,!0)}});return g})},"dojox/fx":function(){define(["./fx/_base"],function(u){return u})},"dojox/fx/_base":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/fx dojo/fx dojo/dom dojo/dom-style dojo/dom-geometry dojo/_base/connect dojo/_base/html".split(" "),function(u,q,e,h,n,a,d,l,k){u=q.getObject("dojox.fx",!0);
q.mixin(u,{anim:e.anim,animateProperty:e.animateProperty,fadeTo:e._fade,fadeIn:e.fadeIn,fadeOut:e.fadeOut,combine:h.combine,chain:h.chain,slideTo:h.slideTo,wipeIn:h.wipeIn,wipeOut:h.wipeOut});u.sizeTo=function(d){var g=d.node=n.byId(d.node),r=d.method||"chain";d.duration||(d.duration=500);"chain"==r&&(d.duration=Math.floor(d.duration/2));var f,l,k,w,u,x=null,z=function(c){return function(){var b=a.getComputedStyle(c),e=b.position,g=b.width,t=b.height;f="absolute"==e?c.offsetTop:parseInt(b.top)||0;
k="absolute"==e?c.offsetLeft:parseInt(b.left)||0;u="auto"==g?0:parseInt(g);x="auto"==t?0:parseInt(t);w=k-Math.floor((d.width-u)/2);l=f-Math.floor((d.height-x)/2);"absolute"!=e&&"relative"!=e&&(b=a.coords(c,!0),f=b.y,k=b.x,c.style.position="absolute",c.style.top=f+"px",c.style.left=k+"px")}}(g),g=e.animateProperty(q.mixin({properties:{height:function(){z();return{end:d.height||0,start:x}},top:function(){return{start:f,end:l}}}},d)),r=e.animateProperty(q.mixin({properties:{width:function(){return{start:u,
end:d.width||0}},left:function(){return{start:k,end:w}}}},d));return h["combine"==d.method?"combine":"chain"]([g,r])};u.slideBy=function(g){var t,r,f=function(f){return function(){var e=a.getComputedStyle(f),g=e.position;t="absolute"==g?f.offsetTop:parseInt(e.top)||0;r="absolute"==g?f.offsetLeft:parseInt(e.left)||0;"absolute"!=g&&"relative"!=g&&(e=d.coords(f,!0),t=e.y,r=e.x,f.style.position="absolute",f.style.top=t+"px",f.style.left=r+"px")}}(g.node=n.byId(g.node));f();g=e.animateProperty(q.mixin({properties:{top:t+
(g.top||0),left:r+(g.left||0)}},g));l.connect(g,"beforeBegin",g,f);return g};u.crossFade=function(a){var d=a.nodes[0]=n.byId(a.nodes[0]),g=k.style(d,"opacity"),f=a.nodes[1]=n.byId(a.nodes[1]);k.style(f,"opacity");return h.combine([e[0==g?"fadeIn":"fadeOut"](q.mixin({node:d},a)),e[0==g?"fadeOut":"fadeIn"](q.mixin({node:f},a))])};u.highlight=function(a){var d=a.node=n.byId(a.node);a.duration=a.duration||400;var g=a.color||"#ffff99",f=k.style(d,"backgroundColor");"rgba(0, 0, 0, 0)"==f&&(f="transparent");
a=e.animateProperty(q.mixin({properties:{backgroundColor:{start:g,end:f}}},a));"transparent"==f&&l.connect(a,"onEnd",a,function(){d.style.backgroundColor=f});return a};u.wipeTo=function(a){a.node=n.byId(a.node);var d=a.node,g=d.style,f=a.width?"width":"height",h={};h[f]={start:function(){g.overflow="hidden";if("hidden"==g.visibility||"none"==g.display)return g[f]="1px",g.display="",g.visibility="",1;var a=k.style(d,f);return Math.max(a,1)},end:a[f]};return e.animateProperty(q.mixin({properties:h},
a))};return u})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"widgets/LayerList/PopupMenuInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all jimu/WidgetManager jimu/portalUrlUtils esri/lang ./NlsStrings".split(" "),function(u,q,e,h,n,a,d,l,k){var g=u([],{_candidateMenuItems:null,_displayItems:null,_layerInfo:null,_layerType:null,_appConfig:null,constructor:function(a,d,f,e){this.nls=k.value;this._layerInfo=
a;this._layerType=f;this.layerListWidget=e;this._initCandidateMenuItems();this._initDisplayItems(d)},_getATagLabel:function(){var a,d;a=this._layerInfo.getUrl();(d=this._layerInfo.isItemLayer())?(a=this._getItemDetailsPageUrl(d)||a,d=this.nls.itemShowItemDetails):!a||"CSVLayer"!==this._layerType&&"KMLLayer"!==this._layerType?(a=a&&"WMSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":"?")+"SERVICE\x3dWMS\x26REQUEST\x3dGetCapabilities":a&&"WFSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":
"?")+"SERVICE\x3dWFS\x26REQUEST\x3dGetCapabilities":a?a:"",d=this.nls.itemDesc):d=this.nls.itemDownload;this._ATagLabelUrl=a;return'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d"'+a+'"\x3e'+d+"\x3c/a\x3e"},_getItemDetailsPageUrl:function(a){var e="";return e=d.getItemDetailsPageUrl(a.portalUrl,a.itemId)},_initCandidateMenuItems:function(){this._candidateMenuItems=[{key:"separator",label:""},{key:"empty",label:this.nls.empty},{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",
label:this.nls.itemTransparency},{key:"setVisibilityRange",label:this.nls.itemSetVisibilityRange},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:"table",label:this.nls.itemToAttributeTable},{key:"controlPopup",label:this.nls.removePopup},{key:"controlLabels",label:this.nls.showLabels},{key:"url",label:this._getATagLabel()}]},_initDisplayItems:function(a){this._displayItems=[];q.forEach(a,function(a){q.forEach(this._candidateMenuItems,function(d){a.key===
d.key&&(this._displayItems.push(e.clone(d)),a.onClick&&(this._displayItem.onClick=a.onClick))},this)},this)},_getSupportTableInfoForAllSublayers:function(a){var d=[];a.traversal(function(a){var f=new h;a.getSupportTableInfo().then(function(d){d.layerInfo=a;f.resolve(d)});d.push(f)});return n(d)},_isSupportedByAT:function(a,d){return q.some(d,function(a){return a.isSupportedLayer?!0:!1})},_isPopupSupported:function(){var a=new h,d=[];this._layerInfo.traversal(function(a){a.isLeaf()&&d.push(a.loadInfoTemplate())});
n(d).then(function(d){q.some(d,function(d){if(d)return a.resolve(!0),!0;a.resolve(!1);return!1})});return a},getDeniedItems:function(){var a=new h,d=[];this.layerListWidget.layerListView.isFirstDisplayedLayerInfo(this._layerInfo)&&d.push({key:"moveup",denyType:"disable"});this.layerListWidget.layerListView.isLastDisplayedLayerInfo(this._layerInfo)&&d.push({key:"movedown",denyType:"disable"});this._ATagLabelUrl||d.push({key:"url",denyType:"disable"});this._layerInfo.canShowLabel()||d.push({key:"controlLabels",
denyType:"hidden"});this._layerInfo.originOperLayer.featureCollection?d.push({key:"setVisibilityRange",denyType:"hidden"}):this._layerInfo.isRootLayer()||"esri.layers.ArcGISTiledMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass?this._layerInfo.isRootLayer()||"esri.layers.ArcGISDynamicMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass||this._layerInfo.getRootLayerInfo().layerObject.supportsDynamicLayers||d.push({key:"setVisibilityRange",denyType:"disable"}):
d.push({key:"setVisibilityRange",denyType:"hidden"});var f=this._isPopupSupported(),g=this._getSupportTableInfoForAllSublayers(this._layerInfo);n({isPopupSupported:f,supportTableInfo:g}).then(e.hitch(this,function(f){f.isPopupSupported||d.push({key:"controlPopup",denyType:"hidden"});f=f.supportTableInfo;var e=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];e&&e.visible?this._isSupportedByAT(e,f)||d.push({key:"table",denyType:"disable"}):d.push({key:"table",denyType:"hidden"});
a.resolve(d)}),function(){a.resolve(d)});return a},getDisplayItems:function(){return this._displayItems},onPopupMenuClick:function(a){var d={closeMenu:!0};switch(a.itemKey){case "zoomto":this._onItemZoomToClick(a);break;case "moveup":this._onMoveUpItemClick(a);break;case "movedown":this._onMoveDownItemClick(a);break;case "table":this._onTableItemClick(a);break;case "transparencyChanged":this._onTransparencyChanged(a);d.closeMenu=!1;break;case "controlPopup":this._onControlPopup();break;case "controlLabels":this._onControlLabels()}return d},
_onItemZoomToClick:function(a){this._layerInfo.zoomTo()},_isValidExtent:function(a){var d=!1;l.isDefined(a)&&l.isDefined(a.xmin)&&isFinite(a.xmin)&&l.isDefined(a.ymin)&&isFinite(a.ymin)&&l.isDefined(a.xmax)&&isFinite(a.xmax)&&l.isDefined(a.ymax)&&isFinite(a.ymax)&&(d=!0);return d},_onMoveUpItemClick:function(a){this._layerInfo.isFirst||a.layerListView.moveUpLayer(this._layerInfo)},_onMoveDownItemClick:function(a){this._layerInfo.isLast||a.layerListView.moveDownLayer(this._layerInfo)},_onTableItemClick:function(d){this._getSupportTableInfoForAllSublayers(this._layerInfo).then(e.hitch(this,
function(g){var f,h=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];this._isSupportedByAT(h,g)&&(f=a.getInstance(),q.forEach(g,function(a){a.isSupportedLayer&&f.triggerWidgetOpen(h.id).then(e.hitch(this,function(e){e&&f.activateWidget(e);d.layerListWidget.publishData({target:"AttributeTable",layer:a.layerInfo})}))},this))}))},_onTransparencyChanged:function(a){this._layerInfo.setOpacity(1-a.extraData.newTransValue)},_onControlPopup:function(a){this._layerInfo.isPopupNestedEnabled()?
this._layerInfo.disablePopupNested():this._layerInfo.enablePopupNested();this._layerInfo.map.infoWindow.hide()},_onControlLabels:function(a){this._layerInfo.canShowLabel()&&(this._layerInfo.isShowLabels()?this._layerInfo.hideLabels():this._layerInfo.showLabels())}});g.create=function(a,d){var f=new h,k=a.isRootLayer(),l={RootLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},
{key:"table"},{key:"separator"},{key:"url"}],RootLayerAndFeatureLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"controlLabels"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],FeatureLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],SublayerOfDynamicMapserviceLayer:[{key:"setVisibilityRange"},
{key:"separator"},{key:"url"}],GroupLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],Table:[{key:"table"},{key:"separator"},{key:"url"}],BasemapLayer:[{key:"zoomto"},{key:"transparency"},{key:"separator"},{key:"url"}],"default":[{key:"url",onClick:null}]};a.getLayerType().then(e.hitch(this,function(e){var h="",h=a.isBasemap()&&a.isRootLayer()?"BasemapLayer":a.isBasemap()?"default":!k||"FeatureLayer"!==e&&"CSVLayer"!==
e&&"ArcGISImageServiceLayer"!==e&&"StreamLayer"!==e&&"ArcGISImageServiceVectorLayer"!==e?k?"RootLayer":"FeatureLayer"===e||"CSVLayer"===e?"FeatureLayer":a.isLeaf()&&a.getRootLayerInfo()&&a.getRootLayerInfo().layerObject&&"esri.layers.ArcGISDynamicMapServiceLayer"===a.getRootLayerInfo().layerObject.declaredClass?"SublayerOfDynamicMapserviceLayer":"GroupLayer"===e?"GroupLayer":"Table"===e?"Table":"default":"RootLayerAndFeatureLayer";f.resolve(new g(a,l[h],e,d))}),e.hitch(this,function(){f.resolve(new g(a,
[{key:"empty"}]))}));return f};return g})},"widgets/LayerList/LayerFilter":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dijit/_TemplatedMixin dojo/text!./LayerFilter.html dojo/dom dojo/on dojo/keys dojo/dom-class dijit/focus jimu/utils jimu/dijit/Search".split(" "),function(u,q,e,h,n,a,d,l,k,g,t,r){return q([u,h],{templateString:n,baseClass:"layer-filter",layerFilterInput:null,isValid:!1,layerListWidget:null,layerInfoIsValidStatus:null,layerInfoIsExpandStatus:null,postMixInProperties:function(){this.inherited(arguments);
this.nls=e.mixin(e.clone(this.layerListWidget.nls),window.jimuNls.common)},constructor:function(){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={}},startup:function(){this.layerFilterInput=(new r({placeholder:this.nls.typeAKeywork,onSearch:e.hitch(this,this._onFilter),searchWhenInput:!0})).placeAt(this.searchInputNode);a.setSelectable(this.cancelButton,!1);this.own(d(this.searchButton,"keydown",e.hitch(this,"_onSearchButtonKey")));this.own(d(this.layerFilterInput.inputSearch,"keydown",
e.hitch(this,"_onLayerFilterInputKey")));this.own(d(this.clearInputButton,"keydown",e.hitch(this,"_onClearInputButtonKey")));this.own(d(this.cancelButton,"keydown",e.hitch(this,"_onCancelButtonKey")))},_updateLayerInfoStatus:function(a){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={};this.layerListWidget.operLayerInfos.traversalAll(e.hitch(this,function(d){if(a){var f;if(0<=d.title.toLowerCase().indexOf(a.toLowerCase()))for(f=d;f;)this.layerInfoIsValidStatus[f.id]=!0,(f=f.parentLayerInfo)&&
(this.layerInfoIsExpandStatus[f.id]=!0);else for(f=d.parentLayerInfo;f;){if(0<=f.title.toLowerCase().indexOf(a.toLowerCase())){this.layerInfoIsValidStatus[d.id]=!0;break}f=f.parentLayerInfo}}else this.layerInfoIsValidStatus[d.id]=!0}))},isValidLayerInfo:function(a){return!this.isValid||this.layerInfoIsValidStatus[a.id]},isExpanded:function(a){return this.isValid&&this.layerInfoIsExpandStatus[a.id]},cancelFilter:function(){this.isValid=!1;this.layerFilterInput.inputSearch.value&&(this.layerFilterInput.inputSearch.value=
"",this.layerListWidget._refresh());k.remove(this.searchButton,"invalid");k.add(this.searchInputNode,"invalid");k.add(this.cancelButton,"invalid");g.focus(this.searchButton)},_onFilter:function(a){a?k.remove(this.clearInputButton,"disable"):k.add(this.clearInputButton,"disable");this._updateLayerInfoStatus(a);this.layerListWidget._refresh()},_onSearchBtnClick:function(){this.isValid=!0;k.add(this.searchButton,"invalid");k.remove(this.searchInputNode,"invalid");k.remove(this.cancelButton,"invalid");
this.layerFilterInput.inputSearch.focus()},_onCancelBtnClick:function(){this.cancelFilter()},_onClearInputButton:function(){this.layerFilterInput.inputSearch.value&&(k.add(this.clearInputButton,"disable"),this.layerFilterInput.inputSearch.focus(),this.layerFilterInput.inputSearch.value="",this._updateLayerInfoStatus(""),this.layerListWidget._refresh())},_onSearchButtonKey:function(a){a.keyCode===l.ENTER&&this._onSearchBtnClick()},_onLayerFilterInputKey:function(a){a.keyCode===l.TAB&&a.shiftKey?(a.stopPropagation(),
a.preventDefault(),this._enableNavMode(a)):a.keyCode!==l.TAB||a.shiftKey?a.keyCode===l.ESCAPE&&(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),k.contains(this.clearInputButton,"disable")?g.focus(this.cancelButton):g.focus(this.clearInputButton))},_onClearInputButtonKey:function(a){a.keyCode===l.TAB&&a.shiftKey?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),g.focus(this.layerFilterInput.inputSearch)):a.keyCode!==
l.TAB||a.shiftKey?a.keyCode===l.ENTER?(a.stopPropagation(),a.preventDefault(),this._onClearInputButton()):a.keyCode===l.ESCAPE&&(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):(a.stopPropagation(),a.preventDefault(),g.focus(this.cancelButton))},_onCancelButtonKey:function(a){a.keyCode===l.TAB&&a.shiftKey?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),g.focus(this.layerFilterInput.inputSearch)):a.keyCode!==l.TAB||a.shiftKey?a.keyCode===l.ENTER?(a.stopPropagation(),
a.preventDefault(),this._onCancelBtnClick()):a.keyCode===l.ESCAPE&&(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a))},_enableNavMode:function(a){a.keyCode!==l.TAB||t.isInNavMode()||k.add(document.body,"jimu-nav-mode")}})})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\r\n    \x3cdiv class\x3d"label"\x3e\r\n      \x3cdiv class\x3d"label-left jimu-float-leading"\x3e${nls.itemOpaque}\x3c/div\x3e\r\n      \x3cdiv class\x3d"label-right jimu-float-trailing"\x3e${nls.itemTransparent}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \r\n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"popup-menu-visible-scale-range-body" data-dojo-attach-point\x3d"setVisibilityRangeNode" data-dojo-attach-event\x3d"onclick:_onSetVisibilityRangeNode"\x3e \r\n  \x3c/div\x3e\r\n\x3cdiv\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScaleMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.section}"\x3e\r\n    \x3cdiv class\x3d"${css.header}"\x3e${labels.current}\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_currentScaleLabel" class\x3d"${css.item} ${css.current}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_scaleInput" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${css.input}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recommendedScaleSection"\x3e\r\n    \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_scaleListHeader"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3col data-dojo-attach-point\x3d"dap_recommendedScales" class\x3d"${css.list}"\x3e\r\n        \x3cli data-dojo-attach-point\x3d"dap_mapScaleItem" class\x3d"${css.item} ${css.selectable}"\x3e\x3c/li\x3e\r\n        \x3c!--additional list items added dynamically--\x3e\r\n      \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScalePreview.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.header}"\x3e${labels.preview}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dap_scalePreviewThumbnail" class\x3d"${css.thumbnail}"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:dojox/form/resources/HorizontalRangeSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onkeyup:_onKeyUp" role\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" dojoAttachEvent\x3d"onmousedown:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv role\x3d"presentation" class\x3d"dojoxRangeSliderBarContainer" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" dojoAttachEvent\x3d"onmousedown:_onBarClick"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClickMax" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" dojoAttachEvent\x3d"onmousedown:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:widgets/LayerList/LayerListView.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layer-list-operations" role\x3d\'button\' aria-haspopup\x3d\'true\' aria-label\x3d"${nls.tipLayerListOperation}" aria-expanded\x3d"false" tabindex\x3d"0" data-dojo-attach-point\x3d"layerListOperations"\x3e\r\n    \x3c!--div class\x3d"setting-image jimu-icon jimu-icon-setting jimu-state-disabled"\x3e\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3ctable class\x3d"layer-list-table"\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"tableListTable"\x3e\x3c/tbody\x3e       \r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/LayerFilter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-input-node invalid" data-dojo-attach-point\x3d"searchInputNode"\x3e\r\n    \x3cdiv class\x3d"clear-input-button disable" tabindex\x3d"0" role\x3d"button" aria-label\x3d\'${nls.tipClearText}\' data-dojo-attach-point\x3d"clearInputButton" data-dojo-attach-event\x3d"click:_onClearInputButton"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-button" data-dojo-attach-point\x3d"searchButton" role\x3d"button" tabindex\x3d"0" data-dojo-attach-event\x3d"click:_onSearchBtnClick"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"cancel-button invalid" data-dojo-attach-point\x3d"cancelButton" role\x3d"button" tabindex\x3d"0" data-dojo-attach-event\x3d"click:_onCancelBtnClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\r\n    \x3cdiv class\x3d"layer-list-title" data-dojo-attach-point\x3d"layerListTitle"\x3e${nls.layers}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-filter-node" data-dojo-attach-point\x3d"layerFilterNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/LayerList/css/style.css":'.jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px; z-index: 0; position: relative;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; margin-bottom: 14px; font-family: "Avenir Heavy"; margin-left: 8px; margin-right: 8px;}.jimu-widget-layerList .layers-section .layer-list-title.disable{margin-bottom: 2px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{height: 40px;}.jimu-widget-layerList .layer-row:hover{background-color: #e3ecf2;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word; cursor: pointer;}.jimu-widget-layerList .col3{width: 24px;}.jimu-widget-layerList .begin-blank-div{width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 12px; height: 12px; cursor: pointer; margin-left: 3px; margin-top: 2px; background-image: url("../images/v_right.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .jimu-widget-layerList .showLegend-div{background-image: url("../images/v_left.png"); margin-left: 0; margin-right: 3px;} .jimu-widget-layerList .showLegend-div.unfold{background-image: url("../images/v.png");}.jimu-widget-layerList .showLegend-div.hidden{background-image: none; cursor: auto;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{width: 33px; text-align: right; display: none;}.jimu-widget-layerList .noLegend-image{display: block; margin: 0 auto;}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{position: relative; font-size: 2px;}.jimu-widget-layerList .div-select .checkbox{cursor: auto;}.jimu-widget-layerList .image-group-div {width: 14px; height: 14px; background-image: url("../images/group_layer.svg"); background-repeat: no-repeat; background-position: center center; background-size: 14px; margin: 1px 0 0 2px; cursor: auto;}.jimu-rtl .jimu-widget-layerList .image-group-div {margin-left: 4px; margin-right: auto;}.jimu-widget-layerList .image-group-div.disable{display: none;}.jimu-widget-layerList .div-content{position: relative; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .div-content.grayed-title{opacity: 0.3;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden; font-size: 11px;}.jimu-widget-layerList .legend-symbol{}.jimu-widget-layerList .legend-label{margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .esriLegendService {padding-bottom: 0;}.jimu-widget-layerList .esriLegendLayerLabel {padding-top: 0; height: 0; display: none;}.jimu-widget-layerList .esriLegendServiceLabel {display: none;}.jimu-widget-layerList .esriLegendLayer{font-size: 12px;}.jimu-widget-layerList .esriLegendMsg{display: none;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 22px; height: 40px; cursor: pointer; border-radius: 2px; float: right; background-image: url("../images/more_normal.svg"); background-repeat: no-repeat; background-position: center 19px;}.jimu-widget-layerList .layers-list-popupMenu-div:hover{background-image: url("../images/more_hover.svg");}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button:hover{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .loading-section {width: 17px; height: 17px; top: 14px; left: 2px; z-index: 1; margin: 0;} .jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .loading-section {left: auto; right: 2px;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{width: 17px; height: 17px; margin: -9px 0 0 2px; border-radius: 25px; background-image: url("../images/loading.gif"); background-repeat: no-repeat; background-position: center center; background-size: contain;}.jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderImageHandleH{background: url(./images/slider-handle.png); width: 10px; border: none; height: 14px;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderDecrementIconH, .jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderDecrementIconH,.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .popup-menu-visible-scale-range-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-visible-scale-range-body .esriVisibleScaleRangeSlider{margin-top: 15px;}.jimu-widget-layerList .jimu-dropmenu .popup-menu-button{width: 22px; height: 22px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 22px; height: 22px; min-width: 13px; background-image: url("../images/more_normal.svg"); background-color: rgba(255, 255, 255, 0); border: 0 solid;}.jimu-widget-layerList .layers-list-popupMenu-div:hover .jimu-icon-btn{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{min-width: 180px; max-width: 330px; outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; font-size: 12px; z-index: 2; right: 0px; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .jimu-dropmenu .drop-menu.no-border{outline-style: none; border: none; box-shadow: none;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .drop-menu{left: 0px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{position: relative; height: 40px; line-height: 40px; white-space: nowrap; padding: 0px 24px; margin: 0 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin: 2px 2px 2px 2px;}.jimu-widget-layerList .jimu-dropmenu .menu-item:focus{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{opacity: 0.4;}.jimu-widget-layerList .jimu-dropmenu .menu-item-hidden{display: none;}.jimu-widget-layerList .jimu-dropmenu .menu-item a{width: 100%;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .menu-item a{right: auto; left: 0;}.jimu-widget-layerList .legends-loading-img{width: 45px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}.jimu-widget-layerList .layer-list-operations{position: absolute; right: 0; top: 0;}.jimu-rtl .jimu-widget-layerList .layer-list-operations{right: auto; left: 0;}.jimu-widget-layerList .layer-list-operations .setting-image{position: relative; right: 11px; top: -1px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .setting-image{right: auto; left: 11px;}.jimu-widget-layerList .layer-list-operations .jimu-icon-btn{background-image: url("../images/operation_normal.svg"); background-color: rgba(255, 255, 255, 0);}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-icon-btn{left: auto; right: -8px;}.jimu-widget-layerList .layer-list-operations:hover .jimu-icon-btn{background-image: url("../images/operation_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .layer-list-operations .drop-menu{min-width:147px !important; top: 21px !important; right: 0 !important; left: auto !important; z-index: 1 !important; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none !important;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .drop-menu{right: auto !important; left: 0 !important;}.jimu-widget-layerList .layer-list-operations .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item{margin: 0; padding: 0 7px; font-size: 12px; padding: 0 20px; margin: 2px 2px 2px 2px;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .layer-list-operations .jimu-loading{font-size: 5px; top: 45px; left: 20px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-loading{left: auto; right: 20px;}.jimu-widget-layerList .layer-filter-node{position: absolute; width: 100%; top: 0;}.jimu-widget-layerList .layer-filter{position: relative;}.jimu-widget-layerList .layer-filter .search-input-node{position: absolute; top: -10px; left: 0; right: 74px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node{left: 70px; right: 0;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input-wrapper{border: 1px solid #cccccc; background-color: #ffffff;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{border: none; padding-left: 32px; padding-right: 30px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{padding-left: 30px; padding-right: 32px;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input:focus{box-shadow: none;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{left: 10px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{right: 10px; left: auto;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn:hover{cursor: auto; background-position: 0 -291px;}.jimu-widget-layerList .layer-filter .search-input-node.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-button{width: 20px; height: 20px; position: absolute; top: -2px; right: 23px; background-image: url("../images/search_normal.svg"); background-repeat: no-repeat; background-position: center; cursor: pointer;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-button{left: 23px; right: auto;}.jimu-widget-layerList .layer-filter .search-button:focus{}.jimu-widget-layerList .layer-filter .search-button:hover{background-image: url("../images/search_hover.svg");}.jimu-widget-layerList .layer-filter .search-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .cancel-button{width: 69px; height: 30px; line-height: 30px; border: 1px solid #cccccc; position: absolute; top: -5px; right: 0; z-index: 1; background-color: #ffffff; text-align: center; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 2px 0 2px;}.jimu-widget-layerList .layer-filter .cancel-button:hover{border: 1px solid #000; font-family: "Avenir Medium";}.jimu-rtl .jimu-widget-layerList .layer-filter .cancel-button{left: 0; right: auto;}.jimu-widget-layerList .layer-filter .cancel-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{width: 15px; height: 25px; position: absolute; top: 7px; right: 10px; z-index: 1; background-image: url("../images/clear.svg"); background-repeat: no-repeat; background-position: center; background-size: 10px 10px;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button.disable{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button:hover{background-image: url("../images/clear_hover.svg");}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{left: 10px; right: auto;}',
"*now":function(u){u(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom dojo/on dojo/query dijit/registry ./LayerListView ./LayerFilter ./NlsStrings jimu/LayerInfos/LayerInfos".split(" "),function(u,q,e,h,n,a,d,l,k,g,t,r,f){return q([u],{baseClass:"jimu-widget-layerList",name:"layerList",layerFilter:null,_denyLayerInfosReorderResponseOneTime:null,_denyLayerInfosIsVisibleChangedResponseOneTime:null,layerListView:null,operLayerInfos:null,postCreate:function(){!1===this.config.showTitle&&
(this.layerListTitle.innerHTML="",n.addClass(this.layerListTitle,"disable"))},startup:function(){this.inherited(arguments);this._createLayerFilter();r.value=this.nls;this._denyLayerInfosIsVisibleChangedResponseOneTime=this._denyLayerInfosReorderResponseOneTime=!1;if(this.map.itemId)f.getInstance(this.map,this.map.itemInfo).then(e.hitch(this,function(d){this.operLayerInfos=d;this.showLayers();this.bindEvents();a.setSelectable(this.layerListBody,!1);a.setSelectable(this.layerListTitle,!1)}));else{var d=
this._obtainMapLayers();f.getInstance(this.map,d).then(e.hitch(this,function(d){this.operLayerInfos=d;this.showLayers();this.bindEvents();a.setSelectable(this.layerListBody,!1);a.setSelectable(this.layerListTitle,!1)}))}},_createLayerFilter:function(){this.layerFilter=(new t({layerListWidget:this})).placeAt(this.layerFilterNode);n.setAttr(this.layerFilter.searchButton,"tabindex",0);n.setAttr(this.layerFilter.searchButton,"aria-label",this.nls.layers+" "+window.jimuNls.common.search);n.addClass(this.layerFilter.searchButton,
"firstFocusNode")},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var a=[],d=[],e={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};h.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);a.isOperationalLayer&&d.push({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "})},this);h.forEach(this.map.layerIds,function(e){e=this.map.getLayer(e);e.isOperationalLayer?d.push({layerObject:e,title:e.label||e.title||e.name||
e.id||" ",id:e.id||" "}):a.push({layerObject:e,id:e.id||" "})},this);e.itemData.baseMap.baseMapLayers=a;e.itemData.operationalLayers=d;return e},showLayers:function(){this.layerListView=(new g({operLayerInfos:this.operLayerInfos,layerListWidget:this,layerFilter:this.layerFilter,config:this.config})).placeAt(this.layerListBody);this.config.expandAllLayersByDefault&&this.layerListView.foldOrUnfoldAllLayers(!1)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},
_refresh:function(){this._clearLayers();this.showLayers()},bindEvents:function(){this.own(d(this.operLayerInfos,"layerInfosChanged",e.hitch(this,this._onLayerInfosChanged)));this.config.showBasemap&&this.own(d(this.operLayerInfos,"basemapLayerInfosChanged",e.hitch(this,this._onLayerInfosChanged)));this.own(d(this.operLayerInfos,"tableInfosChanged",e.hitch(this,this._onTableInfosChanged)));this.own(this.operLayerInfos.on("layerInfosIsVisibleChanged",e.hitch(this,this._onLayerInfosIsVisibleChanged)));
this.own(d(this.operLayerInfos,"layerInfosReorder",e.hitch(this,this._onLayerInfosReorder)));this.own(d(this.map,"zoom-end",e.hitch(this,this._onZoomEnd)));this.own(d(this.operLayerInfos,"layerInfosRendererChanged",e.hitch(this,this._onLayerInfosRendererChanged)));this.own(d(this.operLayerInfos,"layerInfosOpacityChanged",e.hitch(this,this._onLayerInfosOpacityChanged)));this.own(d(this.operLayerInfos,"layerInfosScaleRangeChanged",e.hitch(this,this._onLayerInfosScaleRangeChanged)))},_onLayerInfosChanged:function(){this.layerFilter.cancelFilter();
this.layerListView.refresh()},_onTableInfosChanged:function(){this.layerFilter.cancelFilter();this.layerListView.refresh()},_onLayerInfosIsVisibleChanged:function(a){this._denyLayerInfosIsVisibleChangedResponseOneTime?this._denyLayerInfosIsVisibleChangedResponseOneTime=!1:h.forEach(a,function(a){l("[class~\x3d'visible-checkbox-"+a.id+"']",this.domNode).forEach(function(d){d=k.byNode(d);a.isVisible()?d.check():d.uncheck()},this)},this)},_onZoomEnd:function(){var a=[];this.operLayerInfos.traversal(e.hitch(this,
function(d){a.push(d)}));var d=this;setTimeout(function(){var e=a.shift();l("[class~\x3d'layer-title-div-"+e.id+"']",this.domNode).forEach(function(a){try{e.isInScale()?n.removeClass(a,"grayed-title"):n.addClass(a,"grayed-title")}catch(x){console.warn(x.message)}},d);0<a.length&&setTimeout(arguments.callee,30)},30)},_onLayerInfosReorder:function(){this._denyLayerInfosReorderResponseOneTime?this._denyLayerInfosReorderResponseOneTime=!1:this._refresh()},_onLayerInfosRendererChanged:function(a){try{h.forEach(a,
function(a){this.layerListView.redrawLegends(a)},this)}catch(B){this._refresh()}},_onLayerInfosOpacityChanged:function(a){h.forEach(a,function(a){var d=void 0===a.layerObject.opacity?1:a.layerObject.opacity;a=l("[layercontenttrnodeid\x3d'"+a.id+"']",this.domNode)[0];l(".legends-div.jimu-legends-div-flag img",a).style("opacity",d)},this)},_onLayerInfosScaleRangeChanged:function(a){h.forEach(a,function(a){var d=[];a.traversal(e.hitch(this,function(a){d.push(a)}));var f=this,g=0;setTimeout(function(){var a=
d.slice(g,g+10);g+=10;h.forEach(a,function(a){l("[class~\x3d'layer-title-div-"+a.id+"']",this.domNode).forEach(function(b){try{a.isInScale()?n.removeClass(b,"grayed-title"):n.addClass(b,"grayed-title")}catch(p){console.warn(p.message)}},f)});d.length>g&&setTimeout(arguments.callee,30)},30)},this)},onAppConfigChanged:function(a,d,e){this.appConfig=a}})});