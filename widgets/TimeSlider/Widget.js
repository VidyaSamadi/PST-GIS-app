// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/TimeSlider":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/kernel dojo/has dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_Widget dijit/_Templated dijit/form/HorizontalSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dojox/timing/_base dojox/form/RangeSlider dojo/text!dojox/form/resources/HorizontalRangeSlider.html ../kernel ../lang ../TimeExtent ./_EventedWidget dojo/text!./templates/TimeSlider.html dojo/i18n!../nls/jsapi".split(" "),
function(k,e,d,m,q,r,h,l,c,a,u,b,t,w,y,v,n,x,p,g,f,z,A){c=k([f,a,u],{declaredClass:"esri.dijit.TimeSlider",widgetsInTemplate:!0,templateString:z,intermediateChanges:!1,_slideDuration:1E3,_defaultCount:10,_eventMap:{"time-extent-change":!0,play:!0,pause:!0,next:!0,previous:!0},constructor:function(a,f){e.mixin(this,A.widgets.timeSlider);this._iconClass="tsButton tsPlayButton";this.loop=this.playing=!1;this.thumbCount=1;this.thumbMovingRate=1E3;this._createTimeInstants=!1;this._options=e.mixin({excludeDataAtTrailingThumb:!1,
excludeDataAtLeadingThumb:!1},a.options||{})},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this._timer=new y.Timer;this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=e.hitch(this,"_bumpSlider",1);this._createSlider()},destroy:function(){this._timer.stop();this.timeStops=this._timer=null;this._slider.destroy();this._slider=null;this._hTicks&&(this._hTicks.destroyRecursive(),this._hTicks=null);this._hLabels&&(this._hLabels.destroyRecursive(),
this._hLabels=null);this.inherited(arguments)},onTimeExtentChange:function(){},onPlay:function(){},onPause:function(){},onNext:function(){},onPrevious:function(){},_onHorizontalChange:function(){var a=this._sliderToTimeExtent();this.onTimeExtentChange(a)},_onPlay:function(){this.playing=!this.playing;this._updateUI();this.playing?(this._timer.start(),this.onPlay(this._sliderToTimeExtent())):(this._timer.stop(),this.onPause(this._sliderToTimeExtent()));var a=this._getSliderValue();this._offset=e.isArray(a)?
a[1]-a[0]:0},_onNext:function(){this.playing||(this._bumpSlider(1),this.onNext(this._sliderToTimeExtent()))},_onPrev:function(){this.playing||(this._bumpSlider(-1),this.onPrevious(this._sliderToTimeExtent()))},createTimeStopsByCount:function(a,f){a&&a.startTime&&a.endTime?(f=f||this._defaultCount,this.createTimeStopsByTimeInterval(a,Math.ceil((a.endTime-a.startTime)/(f-1)),"esriTimeUnitsMilliseconds")):console.log(this.NLS_invalidTimeExtent)},createTimeStopsByTimeInterval:function(a,f,p,b){if(a&&
a.startTime&&a.endTime){this.fullTimeExtent=new g(a.startTime,a.endTime);b&&!0===b.resetStartTime&&this._resetStartTime(this.fullTimeExtent,p);this._timeIntervalUnits=p;b=this.fullTimeExtent.startTime;for(var n=[];b<=a.endTime;)n.push(b),b=a._getOffsettedDate(b,f,p);0<n.length&&n[n.length-1]<a.endTime&&n.push(b);this.setTimeStops(n)}else console.log(this.NLS_invalidTimeExtent)},getCurrentTimeExtent:function(){return this._sliderToTimeExtent()},setTimeStops:function(a){this.timeStops=a||[];this._numTicks=
this._numStops=this.timeStops.length;!1===p.isDefined(this.fullTimeExtent)&&(this.fullTimeExtent=new g(a[0],a[a.length-1]))},setLoop:function(a){this.loop=a},setThumbCount:function(a){this.thumbCount=a;this.singleThumbAsTimeInstant(this._createTimeInstants);this._slider&&this._createSlider()},setThumbIndexes:function(a){this.thumbIndexes=e.clone(a)||[0,1];this._initializeThumbs()},setThumbMovingRate:function(a){this.thumbMovingRate=a;this._timer&&this._timer.setInterval(this.thumbMovingRate)},setLabels:function(a){this.labels=
a;this._slider&&this._createSlider()},setTickCount:function(a){this._numTicks=a;this._slider&&this._createSlider()},singleThumbAsTimeInstant:function(a){this._createTimeInstants=a&&1===this.thumbCount},next:function(){this._onNext()},pause:function(){this.playing=!1;this._updateUI();this._timer.stop()},play:function(){!0!==this.playing&&(this.playing=!1,this._onPlay())},previous:function(){this._onPrev()},_setIntermediateChangesAttr:function(a){this.intermediateChanges=!!a;this._slider&&this._slider.set("intermediateChanges",
!!a)},_updateUI:function(){r.remove(this.playPauseBtn.iconNode,this._iconClass);this._iconClass=this.playing?"tsButton tsPauseButton":"tsButton tsPlayButton";r.add(this.playPauseBtn.iconNode,this._iconClass);this.previousBtn.set("disabled",this.playing);this.nextBtn.set("disabled",this.playing)},_createSlider:function(){this._slider&&(this._slider.destroy(),this._slider=null);for(var a=this.domNode;a.parentNode&&!a.dir;)a=a.parentNode;a={onChange:e.hitch(this,"_onHorizontalChange"),showButtons:!1,
discreteValues:this._numStops,slideDuration:this._slideDuration,"class":"ts",dir:"ltr",intermediateChanges:this.intermediateChanges};this._ts=h.create("div",{},m.query(".tsTmp",this.domNode)[0],"first");this._timeSliderTicks=h.create("div",{},this._ts,"first");this._timeSliderLabels=h.create("div",{},this._ts);2===this.thumbCount?this._createRangeSlider(a):this._createSingleSlider(a);this.thumbIndexes=this.thumbIndexes||[0,1];this._createHorizRule();this._createLabels();!0===this._createTimeInstants&&
m.query(".dijitSliderProgressBarH, .dijitSliderLeftBumper, .dijitSliderRightBumper",this._ts).forEach(function(a){l.set(a,{background:"none"})});this._initializeThumbs();d.disconnect(this._onChangeConnect);this._onChangeConnect=d.connect(this._slider,"onChange",e.hitch(this,"_updateThumbIndexes"))},_createRangeSlider:function(a){this._isRangeSlider=!0;this._slider=new (k([b,v],{templateString:n}))(a,this._ts)},_createSingleSlider:function(a){this._isRangeSlider=!1;this._slider=new b(a,this._ts)},
_createHorizRule:function(){this._hTicks&&(this._hTicks.destroyRecursive(),this._hTicks=null);2>this._numTicks||(this._hTicks=new t({container:"topDecoration",ruleStyle:"","class":"tsTicks",count:this._numTicks},this._timeSliderTicks))},_createLabels:function(){this._hLabels&&(this._hLabels.destroyRecursive(),this._hLabels=null);this.labels&&0<this.labels.length&&(this._hLabels=new w({labels:this.labels,labelStyle:"","class":"tsLabels"},this._timeSliderLabels))},_initializeThumbs:function(){if(this._slider){this._offset=
this._toSliderValue(this.thumbIndexes[1])||0;var a=this._toSliderValue(this.thumbIndexes[0]),a=a>this._slider.maximum||a<this._slider.minimum?this._slider.minimum:a;if(!0===this._isRangeSlider){var f=this._toSliderValue(this.thumbIndexes[1]),f=f>this._slider.maximum||f<this._slider.minimum?this._slider.maximum:f;this._setSliderValue([a,f<a?a:f])}else this._setSliderValue(a);this._onHorizontalChange()}},_bumpSlider:function(a){var f=this._getSliderValue(),g=f,p=g,b=a;e.isArray(f)&&(p=f[0],g=f[1],b=
[{change:a,useMaxValue:!0},{change:a,useMaxValue:!1}]);1E-10>Math.abs(p-this._slider.minimum)&&0>a||1E-10>Math.abs(g-this._slider.maximum)&&0<a?this._timer.isRunning&&(this.loop?(this._timer.stop(),this._setSliderValue(this._getSliderMinValue()),a=this._sliderToTimeExtent(),this.onTimeExtentChange(a),this._timer.start(),this.playing=!0):this.pause()):this._slider._bumpValue(b)},_updateThumbIndexes:function(){var a=this._getSliderValue();e.isArray(a)?(this.thumbIndexes[0]=this._toSliderIndex(a[0]),
this.thumbIndexes[1]=this._toSliderIndex(a[1])):this.thumbIndexes[0]=this._toSliderIndex(a)},_sliderToTimeExtent:function(){if(this.timeStops&&0!==this.timeStops.length){var a=new g,f=this._getSliderValue(),p,b;e.isArray(f)?(f[0]>f[1]?(b=f[0],p=f[1]):(p=f[0],b=f[1]),a.startTime=new Date(this.timeStops[this._toSliderIndex(p)]),a.endTime=new Date(this.timeStops[this._toSliderIndex(b)]),this._adjustTimeExtent(a)):(a.startTime=!0===this._createTimeInstants?new Date(this.timeStops[this._toSliderIndex(f)]):
new Date(this.fullTimeExtent.startTime),a.endTime=!0===this._createTimeInstants?a.startTime:new Date(this.timeStops[this._toSliderIndex(f)]));return a}},_adjustTimeExtent:function(a){if((!1!==this._options.excludeDataAtTrailingThumb||!1!==this._options.excludeDataAtLeadingThumb)&&a.startTime.getTime()!==a.endTime.getTime()){if(this._options.excludeDataAtTrailingThumb){var f=a.startTime;f.setUTCSeconds(f.getUTCSeconds()+1)}this._options.excludeDataAtLeadingThumb&&(a=a.endTime,a.setUTCSeconds(a.getUTCSeconds()-
1))}},_resetStartTime:function(a,f){switch(f){case "esriTimeUnitsSeconds":a.startTime.setUTCMilliseconds(0);break;case "esriTimeUnitsMinutes":a.startTime.setUTCSeconds(0,0,0);break;case "esriTimeUnitsHours":a.startTime.setUTCMinutes(0,0,0);break;case "esriTimeUnitsDays":a.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsWeeks":a.startTime.setUTCDate(a.startTime.getUTCDate()-a.startTime.getUTCDay());break;case "esriTimeUnitsMonths":a.startTime.setUTCDate(1);a.startTime.setUTCHours(0,0,0,0);
break;case "esriTimeUnitsDecades":a.startTime.setUTCFullYear(a.startTime.getUTCFullYear()-a.startTime.getUTCFullYear()%10);break;case "esriTimeUnitsCenturies":a.startTime.setUTCFullYear(a.startTime.getUTCFullYear()-a.startTime.getUTCFullYear()%100)}},_getSliderMinValue:function(){return this._isRangeSlider?[this._slider.minimum,this._slider.minimum+this._offset]:this._slider.minimum},_toSliderIndex:function(a){a=Math.floor((a-this._slider.minimum)*this._numStops/(this._slider.maximum-this._slider.minimum));
0>a&&(a=0);a>=this._numStops&&(a=this._numStops-1);return a},_toSliderValue:function(a){return a*(this._slider.maximum-this._slider.minimum)/(this._numStops-1)+this._slider.minimum},_getSliderValue:function(){return this._slider.get("value")},_setSliderValue:function(a){this._slider._setValueAttr(a,!1,!1)}});q("extend-esri")&&e.setObject("dijit.TimeSlider",c,x);return c})},"dojox/timing/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang"],function(k){k.experimental("dojox.timing");k.getObject("timing",
!0,dojox);dojox.timing.Timer=function(e){this.timer=null;this.isRunning=!1;this.interval=e;this.onStop=this.onStart=null};k.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(e){this.isRunning&&window.clearInterval(this.timer);this.interval=e;this.isRunning&&(this.timer=window.setInterval(k.hitch(this,"onTick"),this.interval))},start:function(){if("function"==typeof this.onStart)this.onStart();this.isRunning=!0;this.timer=window.setInterval(k.hitch(this,"onTick"),this.interval)},
stop:function(){if("function"==typeof this.onStop)this.onStop();this.isRunning=!1;window.clearInterval(this.timer)}});return dojox.timing})},"dojox/form/RangeSlider":function(){define(["dojo/_base/kernel","./_RangeSliderMixin","./HorizontalRangeSlider","./VerticalRangeSlider"],function(k,e){k.deprecated("Call require() for HorizontalRangeSlider / VerticalRangeSlider, explicitly rather than 'dojox.form.RangeSlider' itself","","2.0");return e})},"dojox/form/_RangeSliderMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/_base/event dojo/_base/sniff dojo/dom-style dojo/dom-geometry dojo/keys dijit dojo/dnd/Mover dojo/dnd/Moveable dijit/form/_FormValueWidget dijit/focus dojo/fx dojox/fx".split(" "),
function(k,e,d,m,q,r,h,l,c,a,u,b,t,w,y){var v=function(a,g){return a-g};a=k("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments);this.value=d.map(this.value,function(a){return parseInt(a,10)})},postCreate:function(){this.inherited(arguments);this.value.sort(v);var a=this,g=k(n,{constructor:function(){this.widget=a}});this._movableMax=new b(this.sliderHandleMax,{mover:g});this.sliderHandle.setAttribute("aria-valuemin",
this.minimum);this.sliderHandle.setAttribute("aria-valuemax",this.maximum);this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum);this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);g=k(x,{constructor:function(){this.widget=a}});this._movableBar=new b(this.progressBar,{mover:g});this.focusNode.removeAttribute("aria-valuemin");this.focusNode.removeAttribute("aria-valuemax");this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments);this._movableMax.destroy();
this._movableBar.destroy()},_onKeyPress:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey)){var g=a.target===this.sliderHandleMax,f=a.target===this.progressBar,p=e.delegate(c,this.isLeftToRight()?{PREV_ARROW:c.LEFT_ARROW,NEXT_ARROW:c.RIGHT_ARROW}:{PREV_ARROW:c.RIGHT_ARROW,NEXT_ARROW:c.LEFT_ARROW}),b=0,n=!1;switch(a.keyCode){case p.HOME:this._setValueAttr(this.minimum,!0,g);q.stop(a);return;case p.END:this._setValueAttr(this.maximum,!0,g);q.stop(a);return;case p.PREV_ARROW:case p.DOWN_ARROW:n=
!0;case p.NEXT_ARROW:case p.UP_ARROW:b=1;break;case p.PAGE_DOWN:n=!0;case p.PAGE_UP:b=this.pageIncrement;break;default:this.inherited(arguments);return}n&&(b=-b);b&&(f?this._bumpValue([{change:b,useMaxValue:!1},{change:b,useMaxValue:!0}]):this._bumpValue(b,g),q.stop(a))}},_onHandleClickMax:function(a){this.disabled||this.readOnly||(r("ie")||w.focus(this.sliderHandleMax),q.stop(a))},_onClkIncBumper:function(){this._setValueAttr(!1===this._descending?this.minimum:this.maximum,!0,!0)},_bumpValue:function(a,
g){a=e.isArray(a)?[this._getBumpValue(a[0].change,a[0].useMaxValue),this._getBumpValue(a[1].change,a[1].useMaxValue)]:this._getBumpValue(a,g);this._setValueAttr(a,!0,g)},_getBumpValue:function(a,g){var f=g?1:0;g=h.getComputedStyle(this.sliderBarContainer);var b=l.getContentBox(this.sliderBarContainer,g);g=this.discreteValues;f=this.value[f];if(1>=g||Infinity==g)g=b[this._pixelCount];g--;a=this.maximum>this.minimum?(f-this.minimum)*g/(this.maximum-this.minimum)+a:0;0>a&&(a=0);a>g&&(a=g);return a*(this.maximum-
this.minimum)/g+this.minimum},_onBarClick:function(a){this.disabled||this.readOnly||(r("ie")||w.focus(this.progressBar),q.stop(a))},_onRemainingBarClick:function(a){if(!this.disabled&&!this.readOnly){r("ie")||w.focus(this.progressBar);var g=l.position(this.sliderBarContainer,!0),f=l.position(this.progressBar,!0),b=a[this._mousePixelCoord],n=f[this._startingPixelCoord],f=n+f[this._pixelCount],n=this._isReversed()?b<=n:b>=f,b=this._isReversed()?g[this._pixelCount]-b+g[this._startingPixelCoord]:b-g[this._startingPixelCoord];
this._setPixelValue(b,g[this._pixelCount],!0,n);q.stop(a)}},_setPixelValue:function(a,g,f,b){this.disabled||this.readOnly||(a=this._getValueByPixelValue(a,g),this._setValueAttr(a,f,b))},_getValueByPixelValue:function(a,g){var f=this.discreteValues;if(1>=f||Infinity==f)f=g;f--;return(this.maximum-this.minimum)*Math.round((0>a?0:g<a?g:a)/(g/f))/f+this.minimum},_setValueAttr:function(a,g,f){var b=e.clone(this.value);e.isArray(a)?b=a:b[f?1:0]=a;this._lastValueReported="";this.valueNode.value=a=b;b.sort(v);
this.sliderHandle.setAttribute("aria-valuenow",b[0]);this.sliderHandleMax.setAttribute("aria-valuenow",b[1]);t.prototype._setValueAttr.apply(this,arguments);this._printSliderBar(g,f)},_printSliderBar:function(a,g){g=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0;var f=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,b=g;g>f&&(g=f,f=b);var n=this._isReversed()?100*(1-g):100*g,d=this._isReversed()?100*(1-f):100*f,c=this._isReversed()?
100*(1-f):100*g;if(a&&0<this.slideDuration&&this.progressBar.style[this._progressPixelSize]){if(parseFloat(this.progressBar.style[this._handleOffsetCoord]),a=this.slideDuration/10,0!==a){0>a&&(a=0-a);var p={},e={},b={};p[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:n,units:"%"};e[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:d,units:"%"};b[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],
end:c,units:"%"};b[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(f-g),units:"%"};g=m.animateProperty({node:this.sliderHandle.parentNode,duration:a,properties:p});f=m.animateProperty({node:this.sliderHandleMax.parentNode,duration:a,properties:e});a=m.animateProperty({node:this.progressBar,duration:a,properties:b});y.combine([g,f,a]).play()}}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=n+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=
d+"%",this.progressBar.style[this._handleOffsetCoord]=c+"%",this.progressBar.style[this._progressPixelSize]=100*(f-g)+"%"}});var n=k("dijit.form._SliderMoverMax",u,{onMouseMove:function(a){var b=this.widget,f=b._abspos;f||(f=b._abspos=l.position(b.sliderBarContainer,!0),b._setPixelValue_=e.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-f[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?f[b._pixelCount]-a:a,f[b._pixelCount],!1,!0)},destroy:function(a){u.prototype.destroy.apply(this,
arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,!0)}}),x=k("dijit.form._SliderBarMover",u,{onMouseMove:function(a){var b=this.widget;if(!b.disabled&&!b.readOnly){var f=b._abspos,n=b._bar,d=b._mouseOffset;f||(f=b._abspos=l.position(b.sliderBarContainer,!0),b._setPixelValue_=e.hitch(b,"_setPixelValue"),b._getValueByPixelValue_=e.hitch(b,"_getValueByPixelValue"),b._isReversed_=b._isReversed());n||(n=b._bar=l.position(b.progressBar,!0));d||(d=b._mouseOffset=a[b._mousePixelCoord]-n[b._startingPixelCoord]);
a=a[b._mousePixelCoord]-f[b._startingPixelCoord]-d;pixelValues=[a,a+n[b._pixelCount]];pixelValues.sort(v);0>=pixelValues[0]&&(pixelValues[0]=0,pixelValues[1]=n[b._pixelCount]);pixelValues[1]>=f[b._pixelCount]&&(pixelValues[1]=f[b._pixelCount],pixelValues[0]=f[b._pixelCount]-n[b._pixelCount]);f=[b._getValueByPixelValue(b._isReversed_?f[b._pixelCount]-pixelValues[0]:pixelValues[0],f[b._pixelCount]),b._getValueByPixelValue(b._isReversed_?f[b._pixelCount]-pixelValues[1]:pixelValues[1],f[b._pixelCount])];
b._setValueAttr(f,!1,!1)}},destroy:function(){u.prototype.destroy.apply(this,arguments);var a=this.widget;a._abspos=null;a._bar=null;a._mouseOffset=null;a._setValueAttr(a.value,!0)}});return a})},"dojox/fx":function(){define(["./fx/_base"],function(k){return k})},"dojox/fx/_base":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/fx dojo/fx dojo/dom dojo/dom-style dojo/dom-geometry dojo/_base/connect dojo/_base/html".split(" "),function(k,e,d,m,q,r,h,l,c){k=e.getObject("dojox.fx",!0);
e.mixin(k,{anim:d.anim,animateProperty:d.animateProperty,fadeTo:d._fade,fadeIn:d.fadeIn,fadeOut:d.fadeOut,combine:m.combine,chain:m.chain,slideTo:m.slideTo,wipeIn:m.wipeIn,wipeOut:m.wipeOut});k.sizeTo=function(a){var c=a.node=q.byId(a.node),b=a.method||"chain";a.duration||(a.duration=500);"chain"==b&&(a.duration=Math.floor(a.duration/2));var h,l,k,v,n,x=null,p=function(b){return function(){var f=r.getComputedStyle(b),d=f.position,c=f.width,g=f.height;h="absolute"==d?b.offsetTop:parseInt(f.top)||0;
k="absolute"==d?b.offsetLeft:parseInt(f.left)||0;n="auto"==c?0:parseInt(c);x="auto"==g?0:parseInt(g);v=k-Math.floor((a.width-n)/2);l=h-Math.floor((a.height-x)/2);"absolute"!=d&&"relative"!=d&&(f=r.coords(b,!0),h=f.y,k=f.x,b.style.position="absolute",b.style.top=h+"px",b.style.left=k+"px")}}(c),c=d.animateProperty(e.mixin({properties:{height:function(){p();return{end:a.height||0,start:x}},top:function(){return{start:h,end:l}}}},a)),b=d.animateProperty(e.mixin({properties:{width:function(){return{start:n,
end:a.width||0}},left:function(){return{start:k,end:v}}}},a));return m["combine"==a.method?"combine":"chain"]([c,b])};k.slideBy=function(a){var c,b,t=function(a){return function(){var d=r.getComputedStyle(a),e=d.position;c="absolute"==e?a.offsetTop:parseInt(d.top)||0;b="absolute"==e?a.offsetLeft:parseInt(d.left)||0;"absolute"!=e&&"relative"!=e&&(d=h.coords(a,!0),c=d.y,b=d.x,a.style.position="absolute",a.style.top=c+"px",a.style.left=b+"px")}}(a.node=q.byId(a.node));t();a=d.animateProperty(e.mixin({properties:{top:c+
(a.top||0),left:b+(a.left||0)}},a));l.connect(a,"beforeBegin",a,t);return a};k.crossFade=function(a){var h=a.nodes[0]=q.byId(a.nodes[0]),b=c.style(h,"opacity"),t=a.nodes[1]=q.byId(a.nodes[1]);c.style(t,"opacity");return m.combine([d[0==b?"fadeIn":"fadeOut"](e.mixin({node:h},a)),d[0==b?"fadeOut":"fadeIn"](e.mixin({node:t},a))])};k.highlight=function(a){var h=a.node=q.byId(a.node);a.duration=a.duration||400;var b=a.color||"#ffff99",t=c.style(h,"backgroundColor");"rgba(0, 0, 0, 0)"==t&&(t="transparent");
a=d.animateProperty(e.mixin({properties:{backgroundColor:{start:b,end:t}}},a));"transparent"==t&&l.connect(a,"onEnd",a,function(){h.style.backgroundColor=t});return a};k.wipeTo=function(a){a.node=q.byId(a.node);var h=a.node,b=h.style,t=a.width?"width":"height",l={};l[t]={start:function(){b.overflow="hidden";if("hidden"==b.visibility||"none"==b.display)return b[t]="1px",b.display="",b.visibility="",1;var a=c.style(h,t);return Math.max(a,1)},end:a[t]};return d.animateProperty(e.mixin({properties:l},
a))};return k})},"dojox/form/HorizontalRangeSlider":function(){define(["dojo/_base/declare","dojox/form/_RangeSliderMixin","dojo/text!./resources/HorizontalRangeSlider.html","dijit/form/HorizontalSlider"],function(k,e,d,m){return k("dojox.form.HorizontalRangeSlider",[m,e],{templateString:d})})},"dojox/form/VerticalRangeSlider":function(){define(["dojo/_base/declare","dojox/form/_RangeSliderMixin","dojo/text!./resources/VerticalRangeSlider.html","dijit/form/VerticalSlider"],function(k,e,d,m){return k("dojox.form.VerticalRangeSlider",
[m,e],{templateString:d})})},"dijit/form/VerticalSlider":function(){define(["dojo/_base/declare","./HorizontalSlider","dojo/text!./templates/VerticalSlider.html"],function(k,e,d){return k("dijit.form.VerticalSlider",e,{templateString:d,_mousePixelCoord:"pageY",_pixelCount:"h",_startingPixelCoord:"y",_handleOffsetCoord:"top",_progressPixelSize:"height",_descending:!0,_isReversed:function(){return this._descending}})})},"widgets/TimeSlider/SpeedMenu":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SpeedMenu.html dojo/on dojo/query jimu/utils".split(" "),
function(k,e,d,m,q,r,h,l,c,a,u,b){return k([r,h,l,q],{baseClass:"speed-container",templateString:c,nls:null,menuBox:{w:75,h:120},_speedList:{x025:.25,x05:.5,x1:1,x15:1.5,x2:2},postCreate:function(){this.inherited(arguments);this._initSpeedMenu()},startup:function(){this.inherited(arguments)},destroy:function(){this.inherited(arguments)},_initSpeedMenu:function(){Object.keys(this._speedList).forEach(e.hitch(this,function(a){this[a].innerText=b.localizeNumber(this._speedList[a])+"x"}));this.own(a(this.domNode,
"click",e.hitch(this,this._closeSpeedMenu)));this._checks=u(".check",this.speedMenu);this.setSpeed("1")},_onSelectSpeedItem:function(a){m.map(this._checks,e.hitch(this,function(a){d.addClass(a,"hide")}));var b,c;a.target&&((b=d.getAttr(a.target,"data-speed"))?c=a.target:(c=a.target.parentNode,b=d.getAttr(c,"data-speed")));c&&((a=u(".check",c)[0])&&d.removeClass(a,"hide"),this.speedLabelNode.innerHTML=c.innerText,this._speed=b,this.emit("selected",b))},getSpeed:function(){return this._speed},setSpeed:function(b){var c=
null;switch(b){case "0.25":c=this.item025;break;case "0.5":c=this.item05;break;case "1":c=this.item1;break;case "1.5":c=this.item15;break;case "2":c=this.item2;break;default:c=null}c&&a.emit(c,"click",{cancelable:!1,bubbles:!0})},_setMenuPosition:function(){var a=d.position(this.speedLabelNode);0>a.y-this.menuBox.h-2&&d.setStyle(this.speedMenu,{top:"27px",bottom:"auto"});var b=d.getMarginBox(this.domNode);window.isRTL?0>a.x-this.menuBox.w&&d.setStyle(this.speedMenu,{left:0}):a.x+this.menuBox.w>b.w&&
d.setStyle(this.speedMenu,{right:0})},_onSpeedLabelClick:function(a){a.stopPropagation();a.preventDefault();d.hasClass(this.speedMenu,"hide")?(this._setMenuPosition(),this._showSpeedMenu()):this._closeSpeedMenu()},_showSpeedMenu:function(){d.removeClass(this.speedMenu,"hide");this.emit("open")},_closeSpeedMenu:function(){d.addClass(this.speedMenu,"hide");this.emit("close")}})})},"widgets/TimeSlider/TimeProcesser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/config dojo/Evented dijit/_WidgetBase dojo/when dojo/promise/all dojo/Deferred esri/request ./utils moment/moment dojo/date/locale dojo/i18n esri/lang esri/TimeExtent".split(" "),
function(k,e,d,m,q,r,h,l,c,a,u,b,t,w,y){var v=k([q,m],{nls:null,config:null,map:null,layerInfosObj:null,_INIT_TIME_STEAMP:null,setLayerInfosObj:function(a){this.layerInfosObj=a},_getUpdatedFullTime:function(){var a=0,b,c,d=[],a=0;for(b=this.map.layerIds.length;a<b;a++)c=this.map.layerIds[a],c=this.map.getLayer(c),d.push(this._getUpdatedTime(c));a=0;for(b=this.map.graphicsLayerIds.length;a<b;a++)c=this.map.graphicsLayerIds[a],c=this.map.getLayer(c),d.push(this._getUpdatedTime(c));return h(d).then(e.hitch(this,
function(a){return this._getFullTimeExtent(a)}))},_getFullTimeExtent:function(b){return a.getFullTimeExtent(b)},_getUpdatedTime:function(b){if(b&&b.url&&a.hasLiveData(b)){var d=null;return c({url:b.url,callbackParamName:"callback",content:{f:"json",returnUpdates:!0}}).then(e.hitch(this,function(a){a.timeExtent&&2===a.timeExtent.length&&(d=new y,d.startTime=new Date(a.timeExtent[0]),d.endTime=new Date(a.timeExtent[1]),b.timeInfo.timeExtent=d)})).always(e.hitch(this,function(){return r(d||e.getObject("timeInfo.timeExtent",
!1,b)||null)}))}return r(e.getObject("timeInfo.timeExtent",!1,b)||null)},getUpdatedFullTime:function(){var a=0,b,c,d=[],a=0;for(b=this.map.layerIds.length;a<b;a++)c=this.map.layerIds[a],c=this.map.getLayer(c),d.push(this._getUpdatedTime(c));a=0;for(b=this.map.graphicsLayerIds.length;a<b;a++)c=this.map.graphicsLayerIds[a],c=this.map.getLayer(c),d.push(this._getUpdatedTime(c));return h(d).then(e.hitch(this,function(a){return this._getFullTimeExtent(a)}))},setTimeSlider:function(a){this.timeSlider=a;
this._INIT_TIME_STEAMP=(new Date).getTime()},_getTimeFormatLabel:function(c){var n=this.nls.timeExtent,e=null,g=null,f="",h="";if(!c&&this.timeSlider)2===this.timeSlider.thumbCount?(e=this.timeSlider.timeStops[this.timeSlider.thumbIndexes[0]],g=this.timeSlider.timeStops[this.timeSlider.thumbIndexes[1]]):e=this.timeSlider.timeStops[this.timeSlider.thumbIndexes[0]];else if(c||this.timeSlider)e=c.startTime,0<c.endTime.getTime()-c.startTime.getTime()&&(g=c.endTime);else return"";if("auto"===this.config.timeFormat||
"Custom"===this.config.timeFormat&&""===this.config.customDateFormat){var l=null,k=c=null,m=!1,f=v.localeDic[d.locale]||v.localeDic.en;g&&e.getFullYear()===g.getFullYear()?(e.getMonth()===g.getMonth()?e.getDate()===g.getDate()?c=e.getHours()===g.getHours()?e.getMinutes()===g.getMinutes()?e.getSeconds()===g.getSeconds()?f.millisecondTimePattern:f.secondTimePattern:f.minuteTimePattern:f.minuteTimePattern:(2>g.getDate()-e.getDate()&&(c=f.minuteTimePattern),m=!0):m=!0,k="long"):g&&10<g.getFullYear()-
e.getFullYear()?(l=f.yearPattern,m=!0):(m=!0,k="long");f=b.format(e,{datePattern:l,formatLength:k,selector:"date"});c&&(e=b.format(e,{timePattern:c,selector:"time"}),f=t.getLocalization("dojo.cldr","gregorian")["dateTimeFormat-medium"].replace(/\{1\}/g,f).replace(/\{0\}/g,e));a.isValidDataStrByDateLocale(f)||(f="");g&&(m&&(h=b.format(g,{datePattern:l,formatLength:k,selector:"date"})),c&&(e=b.format(g,{timePattern:c,selector:"time"}),h=m&&c?t.getLocalization("dojo.cldr","gregorian")["dateTimeFormat-medium"].replace(/\{1\}/g,
h).replace(/\{0\}/g,e):e));a.isValidDataStrByDateLocale(h)||(h="")}else c="Custom"===this.config.timeFormat?this.config.customDateFormat:this.config.timeFormat,f=u(e.getTime()).format(c),g&&(h=u(g.getTime()).format(c));return n=g?w.substitute({FROMTIME:f,ENDTIME:h},n):f+""},findDefaultInterval:function(a){var b;a=(a.endTime.getTime()-a.startTime.getTime())/10;31104E8<a?(a=Math.round(a/31104E8),b="esriTimeUnitsCenturies"):31104E7<a?(a=Math.round(a/31104E7),b="esriTimeUnitsDecades"):31104E6<a?(a=Math.round(a/
31104E6),b="esriTimeUnitsYears"):2592E6<a?(a=Math.round(a/2592E6),b="esriTimeUnitsMonths"):6048E5<a?(a=Math.round(a/6048E5),b="esriTimeUnitsWeeks"):864E5<a?(a=Math.round(a/864E5),b="esriTimeUnitsDays"):36E5<a?(a=Math.round(a/36E5),b="esriTimeUnitsHours"):6E4<a?(a=Math.round(a/6E4),b="esriTimeUnitsMinutes"):1E3<a?(a=Math.round(a/1E3),b="esriTimeUnitsSeconds"):(a=Math.round(a),b="esriTimeUnitsMilliseconds");0===a&&(a=1);return{interval:a,units:b}},getPropsFromMultiLayerInfos:function(a,b){var c={};
null===b?(c=a,c.thumbCount=2,c.thumbMovingRate=2E3):(c=b,a.timeExtent[0]<c.timeExtent[0]&&(c.timeExtent[0]=a.timeExtent[0]),a.timeExtent[1]>c.timeExtent[1]&&(c.timeExtent[1]=a.timeExtent[1]));return c},getTsPros:function(){var a=new l,b=e.getObject("itemData.widgets.timeSlider.properties",!1,this.map&&this.map.itemInfo),c={};b?(c=e.clone(b),a.resolve(c)):a.resolve(null);return a},findClosestThumbIndex:function(a,b){a=a.timeStops;var c=a[0];if(b<c)return 0;for(var d=1;d<a.length;d++){if(a[d]>=b)return b-
c<a[d]-b?d-1:d;if(d<a.length-1)c=a[d];else return d}},getCurrentTimeStops:function(a){var b=null,c=null;1===this.timeSlider.thumbCount?b=this.timeSlider.timeStops[this.timeSlider.thumbIndexes[0]]:2===this.timeSlider.thumbCount&&(b=this.timeSlider.timeStops[this.timeSlider.thumbIndexes[0]],c=this.timeSlider.timeStops[this.timeSlider.thumbIndexes[1]]);return{timeStamp:a,thumbCount:this.timeSlider.thumbCount,startTime:(new Date(b)).getTime(),endTime:(new Date(c)).getTime()}},setAutoRefreshTimer:function(b){var c=
this.config;if(c&&c.autoRefresh&&!0===c.autoRefresh.isAutoRefresh){if(this._autoRefreshFlag=!0,c=a.getAutoRefreshTime(c))this._autoRefreshTimer=setTimeout(e.hitch(this,function(){var c=this.getCurrentTimeStops(this._INIT_TIME_STEAMP);a.saveToLocalCache(this.widgetId,c);b._closeHanlder();b._openHanlder()}),c)}else this._autoRefreshFlag=!1,this.clearAutoRefreshTimer()},clearAutoRefreshTimer:function(){this._autoRefreshTimer&&clearTimeout(this._autoRefreshTimer)},restoreAutoRefreshTimer:function(b){var c=
a.getCacheByKeys(this.widgetId);if(c&&c.timeStamp&&this._INIT_TIME_STEAMP===c.timeStamp){var d;b.setThumbCount(c.thumbCount);d=this.findClosestThumbIndex(b,c.startTime);1===b.thumbCount?b.setThumbIndexes([d]):2===b.thumbCount&&(c=this.findClosestThumbIndex(b,c.endTime),b.setThumbIndexes([d,c]))}}});v.localeDic={ar:{datePattern:"dd MMMM, yyyy",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},cs:{datePattern:"MMMM d, yyyy",
yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"h:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},da:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},de:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},el:{datePattern:"d MMMM yyyy",yearPattern:"yyyy",
hourTimePattern:"h",minuteTimePattern:"hh:mm",secondTimePattern:"hh:mm:ss",millisecondTimePattern:"hh:mm:ss:SSS"},es:{datePattern:"d' de 'MMMM' de 'yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},et:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},fi:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"t",
minuteTimePattern:"t:mm a",secondTimePattern:"t:mm:ss",millisecondTimePattern:"h:mm:ss:SSS"},fr:{datePattern:"d MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"HH",minuteTimePattern:"HH:mm",secondTimePattern:"HH:mm:ss",millisecondTimePattern:"HH:mm:ss:SSS"},he:{datePattern:"d, MMMM ,yyyy",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},it:{datePattern:"d MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H.mm",
secondTimePattern:"H.mm.ss",millisecondTimePattern:"H.mm.ss.SSS"},ja:{datePattern:"yyyy'\u5e74'M'\u6708'd'\u65e5'",yearPattern:"yyyy'\u5e74'",hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},ko:{datePattern:"yyyy\ub144 M\uc6d4 d\uc77c",yearPattern:"yyyy\ub144",hourTimePattern:"a h\uc2dc",minuteTimePattern:"a h:mm",secondTimePattern:"a h:mm:ss",millisecondTimePattern:"a h:mm:ss:SSS"},lt:{datePattern:"yyyy MMMM dd",yearPattern:"yyyy",
hourTimePattern:"H a",minuteTimePattern:"HH:mm",secondTimePattern:"HH:mm:ss",millisecondTimePattern:"HH:mm:ss:SSS"},lv:{datePattern:"dd.MM.yyyy",yearPattern:"yyyy",hourTimePattern:"H a",minuteTimePattern:"HH:mm",secondTimePattern:"HH:mm:ss",millisecondTimePattern:"HH:mm:ss:SSS"},nb:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H.mm",secondTimePattern:"H.mm.ss",millisecondTimePattern:"H.mm.ss.SSS"},nl:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",
minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},pl:{datePattern:"dd-mm-yyyy",yearPattern:"yyyy",hourTimePattern:"hh",minuteTimePattern:"hh:mm",secondTimePattern:"hh:mm:ss",millisecondTimePattern:"hh:mm:ss:SSS"},"pt-br":{datePattern:"d' de 'MMMM' de 'yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"h:mm a",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},"pt-pt":{datePattern:"d' de 'MMMM' de 'yyyy",yearPattern:"yyyy",hourTimePattern:"H",
minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},ro:{datePattern:"d. MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},ru:{datePattern:"MMMM d, yyyy",yearPattern:"yyyy",hourTimePattern:"H",minuteTimePattern:"h:mm",secondTimePattern:"h:mm:ss",millisecondTimePattern:"h:mm:ss:SSS"},sv:{datePattern:"MMMM d, yyyy",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",
secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},th:{datePattern:"d MMMM,yyyy",yearPattern:"yyyy",hourTimePattern:"H a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},tr:{datePattern:"d MMMM yyyy",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},vi:{datePattern:"d MMMM, yyyy",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",
secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},"zh-cn":{datePattern:"yyyy'\u5e74'M'\u6708'd'\u65e5'",yearPattern:"yyyy'\u5e74'",hourTimePattern:"H",minuteTimePattern:"H:mm",secondTimePattern:"H:mm:ss",millisecondTimePattern:"H:mm:ss:SSS"},"zh-hk":{datePattern:"\u5e74\u6708\u65e5",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},"zh-tw":{datePattern:"\u5e74\u6708\u65e5",yearPattern:"yyyy",
hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"},en:{datePattern:"MMMM d, yyyy",yearPattern:"yyyy",hourTimePattern:"h a",minuteTimePattern:"h:mm a",secondTimePattern:"h:mm:ss a",millisecondTimePattern:"h:mm:ss:SSS a"}};return v})},"widgets/TimeSlider/utils":function(){define("dojo/_base/html dojo/dom-geometry dojo/_base/array esri/layers/TimeInfo jimu/utils esri/TimeExtent libs/storejs/store moment/moment".split(" "),function(k,
e,d,m,q,r,h,l){var c={};c.intervalUnitOptions=[{label:window.jimuNls.timeUnit.year,value:m.UNIT_YEARS},{label:window.jimuNls.timeUnit.month,value:m.UNIT_MONTHS},{label:window.jimuNls.timeUnit.week,value:m.UNIT_WEEKS},{label:window.jimuNls.timeUnit.day,value:m.UNIT_DAYS},{label:window.jimuNls.timeUnit.hour,value:m.UNIT_HOURS},{label:window.jimuNls.timeUnit.minute,value:m.UNIT_MINUTES},{label:window.jimuNls.timeUnit.second,value:m.UNIT_SECONDS},{label:window.jimuNls.timeUnit.milliSecond,value:m.UNIT_MILLISECONDS}];
c.isLayerEnabledTime=function(a,c,b){b||(b=c.getLayerInfoById(a.id));if(b)return a=b.layerObject,a=a.timeInfo&&a.timeInfo.timeExtent,c=!0,b=b.originOperLayer,b.itemProperties&&"undefined"!==typeof b.itemProperties.timeAnimation&&(c=!1),!1===b.timeAnimation&&(c=!1),!0===b.timeAnimation&&(c=!0),b.itemProperties&&"undefined"!==typeof b.itemProperties.timeAnimation&&"undefined"!==typeof b.timeAnimation&&(c=!0),!(!c||!a)};c.setLayersUseMapTimebyConfig=function(a,c){c=c.customLayersConfig;a=a.getLayerInfoArray();
for(var b=0,d=c.length;b<d;b++)for(var e=c[b],h=0,l=a.length;h<l;h++){var u=a[h];e.id===u.id&&u.layerObject.setUseMapTime&&(!0===e.isTimeEnable?u.layerObject.setUseMapTime(!0):u.layerObject.setUseMapTime(!1))}};c.initPositionForTheme={DartTheme:{bottom:140},LaunchpadTheme:{bottom:120}};c.isRunInMobile=function(){return window.appInfo.isRunInMobile};c.isOutOfScreen=function(a,c){var b=e.getMarginBox(a.root);a=b.w;b=b.h;return c&&(c.top>=b||c.left>=a)?!0:!1};c._MINIMODE_HEIGHT=35;c.getMarginPosition=
function(a,d,b){var h=e.getMarginBox(a.root);a=h.w;h=h.h;d=k.getContentBox(d);b.marginPosition={right:a-(d.w+b.left),bottom:h-(c._MINIMODE_HEIGHT+b.top)}};c.setMarginPosition=function(a,d,b){if(b.marginPosition){var h=e.getMarginBox(a.root);a=h.w;var h=h.h,l=k.getContentBox(d);b.top=h-(c._MINIMODE_HEIGHT+b.marginPosition.bottom);b.left=a-(l.w+b.marginPosition.right);0>b.top&&(b.top=0);0>b.left&&(b.left=0)}k.setStyle(d,"top",b.top+"px");k.setStyle(d,"left",b.left+"px")};c.initPosition=function(a,d,
b){var e=window.getAppConfig(),h;e&&e.theme&&e.theme.name&&(h=e.theme.name);e=c.getInitTop(a,h);a=c.getInitLeft(a,d);b.top=e;b.left=a;k.setStyle(d,"top",b.top+"px");k.setStyle(d,"left",b.left+"px")};c.getInitTop=function(a,d){var b=0;return b=e.getMarginBox(a.root).h-(c.initPositionForTheme[d]?c.initPositionForTheme[d].bottom:60)-c._MINIMODE_HEIGHT};c.getInitLeft=function(a,c){a=e.getMarginBox(a.root);c=k.getContentBox(c);return a.w/2-c.w/2};c.isValidDate=function(a){return a instanceof Date&&!isNaN(a.getTime())};
c.isValidDataStrByDateLocale=function(a){return"undefined NaN, NaN"===a?!1:!0};c.hasLiveData=function(a){return!!(a&&a.useMapTime&&a.timeInfo&&a.timeInfo.hasLiveData)};c.getCalendarTime=function(a,c){var b;if("time"===a.timeMode||"min"===a.timeMode||"max"===a.timeMode)b=new Date(a.time);else if("now"===a.timeMode||"today"===a.timeMode)if(b=c?new Date(c):new Date,b="today"===a.timeMode?new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0):b,a=a.calender,c="",a&&a.number&&a.operator&&a.unit){var d=
a.unit;if(-1!==d.indexOf("esriTimeUnits"))(d=d.split("esriTimeUnits"))&&2===d.length&&(c=d[1]);else return console.log("unsupported unit:"+a.unit),new Date(b);"+"===a.operator?b=l(b).add(a.number,c).valueOf():"-"===a.operator&&(b=l(b).subtract(a.number,c).valueOf())}return new Date(b)};c.isConfigLiveMode=function(a){var d=!1,b=!1,e=!1===a.isHonorWebMap;a&&a.customTimeConfig&&a.customTimeConfig.startTime&&a.customTimeConfig.startTime.timeConfig&&a.customTimeConfig.startTime.timeConfig.timeMode&&(d=
c.isLiveTimeMode(a.customTimeConfig.startTime.timeConfig.timeMode));a&&a.customTimeConfig&&a.customTimeConfig.endTime&&a.customTimeConfig.endTime.timeConfig&&a.customTimeConfig.endTime.timeConfig.timeMode&&(b=c.isLiveTimeMode(a.customTimeConfig.endTime.timeConfig.timeMode));return e&&(d||b)};c.isLiveTimeMode=function(a){return!a||"now"!==a&&"today"!==a&&"max"!==a&&"min"!==a?!1:!0};c.timeCalendarForBuilderConfig=function(a){if(!1===a.isHonorWebMap){var d,b;b=new Date;d=c.getCalendarTime(a.customTimeConfig.startTime.timeConfig,
b);b=c.getCalendarTime(a.customTimeConfig.endTime.timeConfig,b);return{startTime:d,endTime:b,interval:null!==a.customTimeConfig.interval?a.customTimeConfig.interval:null,thumbCount:!0===a.customTimeConfig.displayAllData?1:2}}return null};c.getFullTimeExtent=function(a,c){var b=null;d.forEach(a,function(a){a&&(b?(b.startTime>a.startTime&&(b.startTime=new Date(a.startTime.getTime())),b.endTime<a.endTime&&(b.endTime=new Date(a.endTime.getTime()))):b=new r(new Date(a.startTime.getTime()),new Date(a.endTime.getTime())))});
a=1;!0===c&&(a=0);b.startTime=new Date(b.startTime.getFullYear(),b.startTime.getMonth(),b.startTime.getDate(),b.startTime.getHours(),b.startTime.getMinutes(),0,0);b.endTime=new Date(b.endTime.getFullYear(),b.endTime.getMonth(),b.endTime.getDate(),b.endTime.getHours(),b.endTime.getMinutes()+a,0,0);return b};c.getAutoRefreshTime=function(a){var c=0,b="";if(a&&a.autoRefresh&&!0===a.autoRefresh.isAutoRefresh&&a.autoRefresh.interval&&a.autoRefresh.unit){var d=a.autoRefresh.unit;-1!==d.indexOf("esriTimeUnits")&&
(d=d.split("esriTimeUnits"))&&2===d.length&&(b=d[1]);b=b.toUpperCase();"SECONDS"===b?c=a.autoRefresh.interval:"MINUTES"===b?c=60*a.autoRefresh.interval:"HOURS"===b?c=3600*a.autoRefresh.interval:"DAYS"===b&&(c=86400*a.autoRefresh.interval)}return 1E3*c};c.getKey=function(a){return"TimeSlider."+encodeURIComponent(q.getAppIdFromUrl())+"."+a};c.getCacheByKeys=function(a){return h.get(c.getKey(a))};c.saveToLocalCache=function(a,d){c.removeLocalCache(a);h.set(c.getKey(a),d)};c.removeLocalCache=function(a){c.getCacheByKeys(a)&&
h.remove(c.getKey(a))};return c})},"widgets/TimeSlider/LayerProcesser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dijit/_WidgetBase ./utils".split(" "),function(k,e,d,m,q,r){return k([q,m],{nls:null,map:null,layerInfosObj:null,setLayerInfosObj:function(d){this.layerInfosObj=d},setTimeSlider:function(d){this.timeSlider=d},processTimeDisableLayer:function(){var d=0,e,c,d=0;for(e=this.map.layerIds.length;d<e;d++)c=this.map.layerIds[d],c=this.map.getLayer(c),this._processTimeUpdate(c);
d=0;for(e=this.map.graphicsLayerIds.length;d<e;d++)c=this.map.graphicsLayerIds[d],c=this.map.getLayer(c),this._processTimeUpdate(c)},_processTimeUpdate:function(d){var e=r.isLayerEnabledTime(d,this.layerInfosObj);d.setUseMapTime&&(!0!==e?d.setUseMapTime(!1):d.setUseMapTime(!0))},processerDisableLayers:function(h){h&&h.disabledLayers&&d.map(h.disabledLayers,e.hitch(this,function(d){!0!==d.isTimeEnabled&&(d=this.layerInfosObj.getLayerInfoById(d.layerId))&&d.layerObject&&d.layerObject.setUseMapTime&&
d.layerObject.setUseMapTime(!1)}))},hasVisibleTemporalLayer:function(){var d=0,e,c,d=0;for(e=this.map.layerIds.length;d<e;d++)if(c=this.map.layerIds[d],c=this.map.getLayer(c),this._isTimeTemporalLayer(c,!0))return!0;d=0;for(e=this.map.graphicsLayerIds.length;d<e;d++)if(c=this.map.graphicsLayerIds[d],c=this.map.getLayer(c),this._isTimeTemporalLayer(c,!0))return!0;return!1},_isTimeTemporalLayer:function(e,l){if(!e)return!1;var c=e&&e.timeInfo&&e.useMapTime;!0===l&&(c=c&&e.visible);if(c)if("esri.layers.KMLLayer"===
e.declaredClass){if(e=e.getLayers(),d.some(e,function(a){return a.timeInfo&&a.timeInfo.timeExtent?!0:!1}))return!0}else{if(e.timeInfo&&e.timeInfo.timeExtent)return!0}else return!1},_getVisibleTemporalLayerNames:function(){var h=0,l,c,a=[],h=0;for(l=this.map.layerIds.length;h<l;h++)c=this.map.layerIds[h],c=this.map.getLayer(c),this._isTimeTemporalLayer(c,!0)&&a.push(c.id);h=0;for(l=this.map.graphicsLayerIds.length;h<l;h++)c=this.map.graphicsLayerIds[h],c=this.map.getLayer(c),this._isTimeTemporalLayer(c,
!0)&&a.push(c.id);return d.map(a,e.hitch(this,function(a){return this.layerInfosObj.getLayerInfoById(a).title||""}))},_onLayerInfosIsShowInMapChanged:function(h){d.some(h,e.hitch(this,function(d){for(var c=null;!c;)c=this.map.getLayer(d.id),d=d.parentLayerInfo;return this.layerProcesser._isTimeTemporalLayer(c)}))&&this.layerProcesser._onTimeTemportalLayerChanged(this)},_onLayerInfosChanged:function(d,e,c){"added"===e?(d=this.map.getLayer(c.id),this.layerProcesser._isTimeTemporalLayer(d,!0)&&this.layerProcesser._onTimeTemportalLayerChanged(this)):
"removed"===e&&this.layerProcesser._onTimeTemportalLayerChanged(this)},_onTimeTemportalLayerChanged:function(d){"closed"!==d.state&&(d.layerProcesser.hasVisibleTemporalLayer()?d.timeSlider?d.updateLayerLabel():d.showTimeSlider():d.timeSlider&&d.closeTimeSlider())},hasLiveDataLayer:function(){var d=0,e,c,d=0;for(e=this.map.layerIds.length;d<e;d++)if(c=this.map.layerIds[d],c=this.map.getLayer(c),r.hasLiveData(c))return!0;d=0;for(e=this.map.graphicsLayerIds.length;d<e;d++)if(c=this.map.graphicsLayerIds[d],
c=this.map.getLayer(c),r.hasLiveData(c))return!0;return!1}})})},"widgets/TimeSlider/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:dojox/form/resources/HorizontalRangeSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onkeyup:_onKeyUp" role\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" dojoAttachEvent\x3d"onmousedown:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv role\x3d"presentation" class\x3d"dojoxRangeSliderBarContainer" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" dojoAttachEvent\x3d"onmousedown:_onBarClick"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClickMax" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" dojoAttachEvent\x3d"onmousedown:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dojox/form/resources/VerticalRangeSlider.html":'\x3ctable class\x3d"dijitReset dijitSlider dijitSliderV dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconV" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton" dojoAttachEvent\x3d"onclick: increment"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper" dojoAttachEvent\x3d"onclick:_onClkIncBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"leftDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV" style\x3d"text-align:center;height:100%;"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" style\x3d"height:100%;"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3ccenter role\x3d"presentation" style\x3d"position:relative;height:100%;" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableV" style\x3d"vertical-align:top;" role\x3d"slider"\r\n\t\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleV" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onmousedown:_onHandleClick"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onmousedown:_onBarClick"\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableV" style\x3d"vertical-align:top;" role\x3d"slider"\r\n\t\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleV" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onmousedown:_onHandleClickMax"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,rightDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV" style\x3d"text-align:center;height:100%;"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper" dojoAttachEvent\x3d"onclick:_onClkDecBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconV" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton" dojoAttachEvent\x3d"onclick: decrement"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/VerticalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderV" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconV" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"leftDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderDecorationC" style\x3d"height:100%;"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3ccenter class\x3d"dijitReset dijitSliderBarContainerV" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c!--#5629--\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableV" style\x3d"vertical-align:top;"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleV" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,rightDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconV" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/templates/TimeSlider.html":'   \x3cdiv class\x3d"esriTimeSlider"\x3e\r\n   \x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e\r\n   \x3ctr\x3e\r\n   \x3ctd align\x3d"right" valign\x3d"middle"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsPlayButton" dojoAttachEvent\x3d"onClick:_onPlay" dojoAttachPoint\x3d"playPauseBtn" type\x3d"button"\x3e${NLS_play}\x3c/button\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"center" valign\x3d"middle" width\x3d"80%" class\x3d"tsTmp"\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"left" valign\x3d"middle" width\x3d"30"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsPrevButton" dojoAttachEvent\x3d"onClick:_onPrev" dojoAttachPoint\x3d"previousBtn" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"left" valign\x3d"middle"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsNextButton" dojoAttachEvent\x3d"onClick:_onNext" dojoAttachPoint\x3d"nextBtn" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\x3c/td\x3e\r\n   \x3c/tr\x3e    \r\n   \x3c/table\x3e\r\n   \x3c/div\x3e',
"url:widgets/TimeSlider/SpeedMenu.html":'\x3cdiv class\x3d"speed-container jimu-float-trailing" data-dojo-attach-point\x3d"speedContainerNode"\x3e\r\n\t\x3cdiv class\x3d"speed-label" data-dojo-attach-point\x3d"speedLabelNode" data-dojo-attach-event\x3d"click:_onSpeedLabelClick"\x3e1x\x3c/div\x3e\r\n\t\x3cdiv class\x3d"speed-menu hide" data-dojo-attach-point\x3d"speedMenu" data-dojo-attach-event\x3d"click:_onSelectSpeedItem"\x3e\r\n\t\t\x3c!--\x3cdiv class\x3d"speed-menu-item item-label jimu-ellipsis" title\x3d"${nls.speedLabel}"\x3e${nls.speedLabel}\x3c/div\x3e--\x3e\r\n\t\t\x3cdiv class\x3d"speed-menu-item" data-speed\x3d"0.25" data-dojo-attach-point\x3d"item025"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"x025"\x3e\x3c/span\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing check hide"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"speed-menu-item" data-speed\x3d"0.5" data-dojo-attach-point\x3d"item05"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"x05"\x3e\x3c/span\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing check hide"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"speed-menu-item" data-speed\x3d"1" data-dojo-attach-point\x3d"item1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"x1"\x3e\x3c/span\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing check hide"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"speed-menu-item" data-speed\x3d"1.5" data-dojo-attach-point\x3d"item15"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"x15"\x3e\x3c/span\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing check hide"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"speed-menu-item" data-speed\x3d"2" data-dojo-attach-point\x3d"item2"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"x2"\x3e\x3c/span\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing check hide"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/TimeSlider/Widget.html":'\x3cdiv class\x3d"jimu-widget-timeslider mini-mode"\x3e\r\n\t\x3cdiv class\x3d"close-btn" data-dojo-attach-point\x3d"closeBtn"\x3e\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"no-time-content drag-handler" data-dojo-attach-point\x3d"noTimeContentNode"\x3e${nls.disableTips}\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"time-content" data-dojo-attach-point\x3d"timeContentNode"\x3e\r\n\t\t\x3cdiv class\x3d"label-container drag-handler" data-dojo-attach-point\x3d"labelContainer" data-dojo-attach-event\x3d"onclick:_onHandleClick"\x3e\r\n\t\t\t\x3cdiv class\x3d"time-extent-container"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"live-icon hide" data-dojo-attach-point\x3d"liveIcon" title\x3d"${nls.liveData}"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"jimu-ellipsis" data-dojo-attach-point\x3d"timeExtentLabelNode"\x3e${nls.timeExtent}\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\x3cdiv class\x3d"layer-labels jimu-ellipsis" data-dojo-attach-point\x3d"layerLabelsNode"\x3e${nls.layers}\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"slider-content clearFix jimu-float-leading" data-dojo-attach-point\x3d"sliderContent"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"sliderNodeContainer" class\x3d"slider-node-container jimu-float-leading"\x3e\x3c/div\x3e\r\n\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnsContainer" class\x3d"btns-container jimu-float-leading"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"previousBtn" class\x3d"previousBtn btn jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"playBtn" class\x3d"playBtn btn jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"nextBtn" class\x3d"nextBtn btn jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\x3c!--speedMenuNode--\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/TimeSlider/css/style.css":'.jimu-widget-timeslider{position: absolute; background: rgba(0,0,0,0.55); border-radius: 3px; padding: 0 14px; width: 360px !important; z-index: 102 !important; transition: height 0.5s ease; -moz-transition: height 0.5s ease; -webkit-transition: height 0.5s ease; -o-transition: height 0.5s ease;}.jimu-rtl .jimu-widget-timeslider{right: auto !important;}.jimu-widget-timeslider .esriTimeSlider{z-index: 99;}.jimu-widget-timeslider .no-time-content,.jimu-widget-timeslider .time-content{position: relative; display: none; z-index: 0;}.jimu-widget-timeslider .no-time-content{height: 30px; padding: 0px 10px; line-height: 30px; font-size: 14px; color: #fff;}.jimu-widget-timeslider .time-content{height: 72px;}.jimu-widget-timeslider .label-container{padding: 10px 15px 10px 10px; font-size: 12px;}.jimu-widget-timeslider .drag-handler{cursor: move;}.jimu-widget-timeslider .time-extent-container{display: flex; align-items: center; justify-content: left; color: #fff; font-family: AvenirNext-Medium; color: #FFFFFF; line-height: 20px; margin-bottom: 5px;}.jimu-widget-timeslider .live-icon{height: 10px; width: 22px; background: url("images/live.svg") no-repeat; background-position: 50% 50%; vertical-align: middle; position: relative; left: auto; right: auto;}.jimu-rtl .jimu-widget-timeslider .live-icon{}.jimu-widget-timeslider .layer-labels{opacity: 0.8; font-family: AvenirNext-Regular; color: #FFFFFF;}.jimu-widget-timeslider .slider-content{position: absolute; margin: auto; bottom: 20px; width: 100%; height: 32px; opacity: 1; transition: opacity 0.5s ease; -moz-transition: opacity 0.5s ease; -webkit-transition: opacity 0.5s ease; -o-transition: opacity 0.5s ease;}.jimu-widget-timeslider .slider-content .esriTimeSlider{width: 224px; margin: 5px 8px 0 8px;}.jimu-widget-timeslider .speed-container{position: relative; height: 16px; width: 28px; cursor: pointer; margin: 0 10px; bottom: -2px;}.jimu-widget-timeslider .speed-menu{width: 75px; position: absolute; z-index: 104; bottom: 27px; text-align: left; font-size: 12px; background: #FFFFFF; color: #000000; box-shadow: 0 2px 4px 0;}.jimu-rtl .jimu-widget-timeslider .speed-menu{text-align: right;}.jimu-widget-timeslider .speed-menu-item{width: 100%; display: inline-block; height: 24px; line-height: 24px; padding-left: 10px;}.jimu-rtl .jimu-widget-timeslider .speed-menu-item{padding-left: 0; padding-right: 10px;}.jimu-widget-timeslider .item-label {border-bottom: 1px solid #c9e0f6;}.jimu-widget-timeslider .speed-menu-item:hover{background: #EEEEEE;}.jimu-widget-timeslider .speed-label{width: 28px; height: 16px; font-family: Avenir-Medium; font-size: 12px; color: #000000; text-align: center; opacity: 0.6; background: #FFFFFF; border-radius: 100px; position: absolute;}.jimu-widget-timeslider .speed-label:hover{opacity: 1; background: #FFFFFF;}.jimu-widget-timeslider .esriTimeSlider .tsTicks{display: none;}.jimu-widget-timeslider .esriTimeSlider .ts {padding: 0;}.jimu-widget-timeslider.mobile {width:100% !important; top:auto !important; bottom:0 !important; left:0 !important;}.jimu-widget-timeslider.mobile .esriTimeSlider{width: 100%; margin: 0; margin-bottom: 10px;}.jimu-widget-timeslider.mobile .slider-content{bottom: 9px;}.jimu-widget-timeslider.mobile .slider-node-container{width:100%;}.jimu-widget-timeslider.mobile .label-container .time-extent-container{justify-content: center;}.jimu-widget-timeslider.mobile .label-container .layer-labels{text-align: center;}.jimu-widget-timeslider .hide {display: none !important;}.jimu-widget-timeslider .clearFix {*overflow: hidden; *zoom: 1;}.jimu-widget-timeslider .clearFix:after {display: table; content: ""; width: 0; clear: both;}.jimu-widget-timeslider .close-btn{height: 10px; width: 10px; background: url("images/close.svg") no-repeat; background-position: 50% 50%; cursor: pointer; vertical-align: middle; position: absolute; right:14px; top:14px; z-index: 1;}.jimu-rtl .jimu-widget-timeslider .close-btn{right:auto; left:14px;}.jimu-widget-timeslider .esriTimeSlider .dijitInline.dijitButtonNode{background: transparent; border: none; box-shadow: none}.jimu-widget-timeslider .esriTimeSlider .dijitSliderImageHandleH{top:-8px}.jimu-widget-timeslider .esriTimeSlider .dojoxRangeSlider .dijitSliderImageHandleH{height: 8px; width: 8px; background: url("images/track.svg") no-repeat; background-position: 50% 50%; cursor: pointer;}.jimu-widget-timeslider .esriTimeSlider .dojoxRangeSlider .dijitSliderImageHandleH:hover {background: url("images/track_hover.svg") no-repeat;}.jimu-widget-timeslider .dijitSliderLeftBumper{border-radius: 10px 0 0 10px;}.jimu-widget-timeslider .dijitSliderRightBumper{border-radius: 0 10px 10px 0;}.jimu-widget-timeslider .dijitSlider .dijitSliderProgressBarH,.jimu-widget-timeslider .dijitSlider .dijitSliderLeftBumper{background-image: none; background-color: #24B5CC;}.jimu-widget-timeslider .dijitSlider.dojoxRangeSlider .dijitSliderLeftBumper{background: #FFFFFF !important;}.jimu-widget-timeslider .btns-container{margin-left: auto; margin-bottom: 12px;}.jimu-widget-timeslider .previousBtn {height: 20px; width: 20px; background: url("images/skip-previous.svg") no-repeat; background-position: 50% 50%; cursor: pointer;}.jimu-widget-timeslider .previousBtn:hover {background: url("images/skip-previous_hover.svg") no-repeat;}.jimu-widget-timeslider .nextBtn {height: 20px; width: 20px; background: url("images/skip-next.svg") no-repeat; background-position: 50% 50%; cursor: pointer;}.jimu-widget-timeslider .nextBtn:hover {background: url("images/skip-next_hover.svg") no-repeat;}.jimu-widget-timeslider .playBtn{height: 20px; width: 20px; background: url("images/play.svg") no-repeat; background-position: 50% 50%; cursor: pointer; margin: 0px 6px;}.jimu-widget-timeslider .playBtn:hover {background: url("images/play_hover.svg") no-repeat;}.jimu-widget-timeslider .playBtn.pause{height: 20px; width: 20px; background: url("images/pause.svg") no-repeat; background-position: 50% 50%; cursor: pointer;}.jimu-widget-timeslider .playBtn.pause:hover {background: url("images/pause_hover.svg") no-repeat;}.check{background: url("images/check.svg") no-repeat; width: 18px; height: 12px; display: inline-block; margin: 5px;}.jimu-widget-timeslider.mini-mode {height:35px !important; background: rgba(0,0,0,0.4);}.jimu-widget-timeslider.mini-mode .time-content{height: 35px;}.jimu-widget-timeslider.mini-mode .label-container{padding: 0;}.jimu-widget-timeslider.mini-mode .label-container .layer-labels{display: none !important;}.jimu-widget-timeslider.mini-mode .slider-content{opacity: 0;}.jimu-widget-timeslider.mini-mode .slider-content .esriTimeSlider{margin: 0; bottom: 0;}.jimu-widget-timeslider.mini-mode .slider-content .dijitSlider .dijitSliderRemainingBarH,.jimu-widget-timeslider.mini-mode .slider-content .dijitSlider .dijitSliderRightBumper,.jimu-widget-timeslider.mini-mode .dijitSlider.dojoxRangeSlider .dijitSliderLeftBumper,.jimu-widget-timeslider.mini-mode .dijitSlider.dojoxRangeSlider .dijitSliderBottomBumper{background-color: #333333; border-color: #333333;}.jimu-widget-timeslider.mini-mode .close-btn,.jimu-widget-timeslider.mini-mode .btns-container,.jimu-widget-timeslider.mini-mode .speed-container{display: none;}.jimu-widget-timeslider.mini-mode .esriTimeSlider .dijitSliderImageHandleH{display: none;}.jimu-widget-timeslider.mini-mode .time-extent-container{padding: 6px; justify-content: center;}.jimu-widget-timeslider.mini-mode .live-icon{position: absolute; left: 6px;}.jimu-rtl .jimu-widget-timeslider.mini-mode .live-icon{left: auto; right: 6px;}.jimu-widget-timeslider.mini-mode .slider-content .esriTimeSlider{bottom: -45px !important; width: 100%;}.mini-mode.mobile .slider-content .esriTimeSlider{bottom: -33px;}.jimu-widget-timeslider.mini-mode .slider-node-container{width:100%; overflow: hidden;}.DartTheme .jimu-widget-timeslider .dijitSliderImageHandle:after{display:none;}.LaunchpadTheme .jimu-widget-timeslider{position: absolute;}.LaunchpadTheme .jimu-widget-timeslider .dijitSliderImageHandle:after{display:none;}',
"*now":function(k){k(['dojo/i18n!*preload*widgets/TimeSlider/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/fx jimu/WidgetManager dojo/dnd/move dojo/on dojo/query dojo/Deferred dojo/dom-geometry jimu/LayerInfos/LayerInfos jimu/BaseWidget esri/TimeExtent esri/dijit/TimeSlider ./SpeedMenu jimu/utils ./TimeProcesser ./LayerProcesser ./utils".split(" "),function(k,e,d,m,q,r,h,l,c,a,u,b,t,w,y,v,n,x,p,g){return k([t],{baseClass:"jimu-widget-timeslider",clasName:"esri.widgets.TimeSlider",speedMenu:null,_showed:!1,_timeHandles:null,
layerInfosObj:null,_layerInfosDef:null,_timeSliderPropsDef:null,_miniModeTimer:null,_KEEP_AUTO_RESTART:null,_LAST_SWIPE_TIME:null,_LAST_SPEED_RATE:null,postCreate:function(){this.inherited(arguments);this._timeHandles=[];this.layerProcesser=new p({map:this.map,config:this.config});this.timeProcesser=new x({map:this.map,nls:this.nls,config:this.config,widgetId:this.id});this._initLayerInfosObj().then(e.hitch(this,function(){this.timeProcesser.setLayerInfosObj(this.layerInfosObj);this.layerProcesser.setLayerInfosObj(this.layerInfosObj);
this.layerProcesser.processTimeDisableLayer()}))},startup:function(){this.inherited(arguments);this.own(l(this.map,"resize",e.hitch(this,this._onMapResize)));this.own(l(this.closeBtn,"click",e.hitch(this,this._closeHanlder)));this.own(l(this.domNode,"mouseover",e.hitch(this,function(){g.isRunInMobile()||this._clearMiniModeTimer()})));this.own(l(this.domNode,"mouseout",e.hitch(this,function(){g.isRunInMobile()||this._setMiniModeTimer()})));this.own(l(this.domNode,"click",e.hitch(this,function(){g.isRunInMobile()&&
(this._clearMiniModeTimer(),this._setMiniModeTimer(),d.hasClass(this.domNode,"mini-mode")&&(d.removeClass(this.domNode,"mini-mode"),this._adaptResponsive()))})));!1===this.config.isHonorWebMap&&this.config.customLayersConfig&&g.setLayersUseMapTimebyConfig(this.layerInfosObj,this.config);g.isConfigLiveMode(this.config)&&this.layerProcesser.hasLiveDataLayer()?d.removeClass(this.liveIcon,"hide"):d.addClass(this.liveIcon,"hide")},setPosition:function(){if(!this._isSetPosition){var a=this.map.id,b=n.getPositionStyle(this.position);
d.place(this.domNode,a);d.setStyle(this.domNode,b);this._isSetPosition=!0}},resize:function(){this._onMapResize()},onOpen:function(){this._isTestSizeFlag||(this._closeOthersTimeSlider(),this._initLayerInfosObj().then(e.hitch(this,function(){this.layerProcesser.hasVisibleTemporalLayer()?this._showed||this.showTimeSlider():this._showNoTimeLayer();g.initPosition(this.map,this.domNode,this.position);this._adaptResponsive();this._setPlayBtnStyleTimer()})))},_closeOthersTimeSlider:function(){var a=r.getInstance().getWidgetsByName("TimeSlider");
m.forEach(a,e.hitch(this,function(a){"opened"===a.state&&this.id!==a.id&&r.getInstance().closeWidget(a)}))},_openHanlder:function(){r.getInstance().openWidget(this)},onClose:function(){this._initLayerInfosObj().then(e.hitch(this,function(){this.layerProcesser.hasVisibleTemporalLayer()?this._showed&&(this.timeSlider.pause(),this.closeTimeSlider()):(d.setStyle(this.noTimeContentNode,"display","none"),this._showed=!1,this.map.removeTimeSlider&&this.map.removeTimeSlider());this._cleanPlayBtnStyleTimer()}))},
_closeHanlder:function(){r.getInstance().closeWidget(this)},_showNoTimeLayer:function(){d.setStyle(this.noTimeContentNode,"display","block");d.setStyle(this.timeContentNode,"display","none");this._showed=!0},showTimeSlider:function(){d.setStyle(this.noTimeContentNode,"display","none");this.createTimeSlider().then(e.hitch(this,function(){"undefined"===typeof this.timeSlider?this._showNoTimeLayer():(this.timeProcesser.setTimeSlider(this.timeSlider),this.layerProcesser.setTimeSlider(this.timeSlider),
this._updateTimeSliderUI(),this.playBtn&&d.hasClass(this.playBtn,"pause")&&d.removeClass(this.playBtn,"pause"),d.setStyle(this.domNode,"display","block"),d.setStyle(this.timeContentNode,"display","block"),d.addClass(this.domNode,"show-time-slider"),this._initSpeedMenu(),q.animateProperty({node:this.timeContentNode,properties:{opacity:{start:0,end:1}},onEnd:e.hitch(this,function(){this._showed=!0;!1!==this.config.autoPlay&&!1===d.hasClass(this.playBtn,"pause")&&l.emit(this.playBtn,"click",{cancelable:!1,
bubbles:!0});this._adaptResponsive()}),duration:500}).play())}))},closeTimeSlider:function(){this._showed=this._isSetPosition=this._draged=!1;this._timeSliderPropsDef=null;d.setStyle(this.domNode,"display","none");this.removeTimeSlider();this._destroySpeedMenu();q.animateProperty({node:this.timeContentNode,properties:{opacity:{start:1,end:0}},onEnd:e.hitch(this,this._onCloseTimeSliderEnd),duration:500}).play()},_onCloseTimeSliderEnd:function(){this._destroyed||(d.removeClass(this.domNode,"show-time-slider"),
"closed"===this.state&&(d.removeClass(this.domNode,"mobile-time-slider"),d.removeClass(this.timeContentNode,"mobile")))},getTimeSliderProps:function(){this._timeSliderPropsDef||(this._timeSliderPropsDef=new a,this.own(this._timeSliderPropsDef),this.timeProcesser.getTsPros().then(e.hitch(this,function(a){this.timeProcesser._getUpdatedFullTime().then(e.hitch(this,function(b){this._timeSliderPropsDef.resolve({prop:a,fulltime:b})}))})));return this._timeSliderPropsDef},createTimeSlider:function(){return this.getTimeSliderProps().then(e.hitch(this,
function(a){var b=a.prop,c=a.fulltime;a=null;if(this.timeSlider)return this.timeSlider;this.sliderNode=d.create("div",{},this.sliderNodeContainer);this.timeSlider=new y({},this.sliderNode);this.map.setTimeSlider(this.timeSlider);if(!1===this.config.isHonorWebMap){b=g.timeCalendarForBuilderConfig(this.config);null!==b&&(b.startTime||b.endTime)||console.log("timeSlider: time param error");a=new w(b.startTime,b.endTime);b.interval.number||b.interval.units||(b.interval=this.timeProcesser.findDefaultInterval(a));
this.timeSlider.setThumbCount(b.thumbCount);this.timeSlider.setThumbMovingRate(2E3);if("0"===b.interval.number||0===b.interval.number)b.interval.number=1;this.timeSlider.createTimeStopsByTimeInterval(a,b.interval.number,b.interval.units);this._LAST_SWIPE_TIME&&(this._LAST_SWIPE_TIME=null)}else b?(a=b.startTime&&b.endTime?new w(new Date(b.startTime),new Date(b.endTime)):b.startTime?new w(new Date(b.startTime),c.endTime):b.endTime?new w(c.startTime,new Date(b.endTime)):new w(c.startTime,c.endTime),
a.startTime>a.endTime&&(a=new w(c.startTime,c.endTime)),this.timeSlider.setThumbCount(b.thumbCount),b.numberOfStops?this.timeSlider.createTimeStopsByCount(a,b.numberOfStops+1):this.timeSlider.createTimeStopsByTimeInterval(a,b.timeStopInterval.interval,b.timeStopInterval.units),this.timeSlider.setThumbMovingRate(b.thumbMovingRate),b.currentTimeExtent?(b.currentTimeExtent[0]||(b.currentTimeExtent[0]=a.startTime.getTime()),b.currentTimeExtent[1]||(b.currentTimeExtent[1]=a.endTime.getTime()),1===b.thumbCount?
this.timeSlider.setThumbIndexes([this.timeProcesser.findClosestThumbIndex(this.timeSlider,b.currentTimeExtent[1])]):(a=this.timeProcesser.findClosestThumbIndex(this.timeSlider,b.currentTimeExtent[0]),b.currentTimeExtent[0]===b.currentTimeExtent[1]?this.timeSlider.setThumbIndexes([a,a]):(b=this.timeProcesser.findClosestThumbIndex(this.timeSlider,b.currentTimeExtent[1]),a<b?this.timeSlider.setThumbIndexes([a,b]):this.timeSlider.setThumbIndexes([a,a+1])))):2===b.thumbCount&&this.timeSlider.setThumbIndexes([0,
1])):(b={thumbCount:2},this.timeSlider.setThumbCount(b.thumbCount),this.timeSlider.setThumbIndexes([0,1]),this.timeSlider.setThumbMovingRate(2E3),b.timeStopInterval=this.timeProcesser.findDefaultInterval(c),this.timeSlider.createTimeStopsByTimeInterval(c,b.timeStopInterval.interval,b.timeStopInterval.units));25<this.timeSlider.timeStops.length&&this.timeSlider.setTickCount(0);b=!0;!1===this.config.loopPlay&&(b=!1);this.timeSlider.setLoop(b);this.timeSlider.startup();this._KEEP_AUTO_RESTART&&(this.timeSlider.play(),
this._KEEP_AUTO_RESTART=null);this._timeHandles.push(l(this.timeSlider,"time-extent-change",e.hitch(this,this.onTimeSliderChange)));return this.timeSlider}))},onTimeSliderChange:function(a){this.updateTimeExtentLabel(a);g.isConfigLiveMode(this.config)&&this.timeCalendarDataAutoRefresh(a)},timeCalendarDataAutoRefresh:function(a){if(a&&a.startTime){var b=1<=this.timeSlider.timeStops.length?this.timeSlider.timeStops.length-1:0,c=this.timeSlider.timeStops[0].getTime(),b=this.timeSlider.timeStops[b].getTime(),
d=!1,f=a.startTime.getTime();a=a.endTime.getTime();this._LAST_SWIPE_TIME?this.timeSlider.playing&&(1===this.timeSlider.thumbCount?a===c&&this._LAST_SWIPE_TIME.endTime===b&&(d=!0):f===c&&this._LAST_SWIPE_TIME.endTime===b&&(d=!0)):(this._LAST_SWIPE_TIME={},d=!1);this._LAST_SWIPE_TIME.startTime=f;this._LAST_SWIPE_TIME.endTime=a;d&&(console.log("auto refresh"),this._KEEP_AUTO_RESTART=!0,this._closeHanlder(),this._openHanlder())}},_updateTimeSliderUI:function(){this.updateLayerLabel();this.updateTimeExtentLabel();
this._updateBtnsUI()},_updateBtnsUI:function(){var a=c(".esriTimeSlider \x3e table \x3e tbody \x3e tr \x3e td \x3e span \x3e span",this.esriTimeSlider);a&&3===a.length&&(this._rawPlayBtn=a[0],this._rawPreviousBtn=a[1],this._rawNextBtn=a[2]);(a=c(".esriTimeSlider \x3e table \x3e tbody \x3e tr \x3e td",this.esriTimeSlider))&&4===a.length&&(d.addClass(a[0],"hide"),d.addClass(a[2],"hide"),d.addClass(a[3],"hide"));this._previousBtnHandler||(this._previousBtnHandler=this.own(l(this.previousBtn,"click",
e.hitch(this,function(){l.emit(this._rawPreviousBtn,"click",{cancelable:!1,bubbles:!0})}))));this._playBtnHandler||(this._playBtnHandler=this.own(l(this.playBtn,"click",e.hitch(this,function(a){l.emit(this._rawPlayBtn,"click",{cancelable:!1,bubbles:!0});d.hasClass(this.playBtn,"pause")?d.removeClass(this.playBtn,"pause"):(d.addClass(this.playBtn,"pause"),g.isRunInMobile()&&(d.addClass(this.domNode,"mini-mode"),this._adaptResponsive()));var b=this.timeSlider._slider,c;c=e.isArray(b.value)?b.value[1]:
b.value;!0!==this.timeSlider.loop&&c===b.maximum&&(this.timeSlider.play(),1<this.timeSlider.thumbCount?this.timeSlider.setThumbIndexes([0,1]):this.timeSlider.setThumbIndexes(0));a.stopPropagation();a.preventDefault()}))));this._nextBtnHandler||(this._nextBtnHandler=this.own(l(this.nextBtn,"click",e.hitch(this,function(){l.emit(this._rawNextBtn,"click",{cancelable:!1,bubbles:!0})}))));window.isRTL&&(d.place(this.previousBtn,this.playBtn,"after"),d.place(this.nextBtn,this.playBtn,"before"))},removeTimeSlider:function(){m.forEach(this._timeHandles,
function(a){a&&a.remove&&a.remove()});this.timeSlider&&!this.timeSlider._destroyed&&(this.timeSlider.destroy(),this.timeSlider=null);this.map&&this.map.setTimeExtent()},updateLayerLabel:function(){if(this.config.showLabels){d.setStyle(this.layerLabelsNode,"display","block");var a=this.nls.layers,b=this.layerProcesser._getVisibleTemporalLayerNames(),a=a+b.join(",");this.layerLabelsNode.innerHTML=a;d.setAttr(this.layerLabelsNode,"title",a)}else d.setStyle(this.layerLabelsNode,"display","none")},updateTimeExtentLabel:function(a){a=
this.timeProcesser._getTimeFormatLabel(a);this.timeExtentLabelNode.innerHTML=a;d.setAttr(this.timeExtentLabelNode,"title",a)},_adaptResponsive:function(a){this._showed&&setTimeout(e.hitch(this,function(){g.isRunInMobile()?(this.disableMoveable(),d.addClass(this.timeContentNode,"mobile"),d.addClass(this.domNode,"mobile")):(a&&"undefined"!==typeof a.refreshMoveable&&!1===a.refreshMoveable||("none"!==d.getStyle(this.noTimeContentNode,"display")?this.dragHandler=this.noTimeContentNode:this.dragHandler=
this.labelContainer,this.makeMoveable(this.dragHandler)),d.removeClass(this.timeContentNode,"mobile"),d.removeClass(this.domNode,"mobile"));this._setPopupPosition(g.isRunInMobile())}),10)},_setPopupPosition:function(a){a?this.config.showLabels?d.setStyle(this.domNode,"height","128px"):d.setStyle(this.domNode,"height","108px"):(this.config.showLabels?d.setStyle(this.domNode,"height","92px"):d.setStyle(this.domNode,"height","72px"),this._draged||g.initPosition(this.map,this.domNode,this.position),!this._moving&&
this.position&&this.position.left&&this.position.top&&(d.setStyle(this.domNode,"top",this.position.top+"px"),d.setStyle(this.domNode,"left",this.position.left+"px")));this._setUI(a)},_setUI:function(a){var b=d.getContentBox(this.btnsContainer);a?(a=window.innerWidth/2-b.w/2,window.isRTL?d.setStyle(this.btnsContainer,"margin-right",a+"px"):d.setStyle(this.btnsContainer,"margin-left",a+"px"),this.config.showLabels&&!d.hasClass(this.domNode,"mini-mode")?d.setStyle(this.sliderContent,"bottom","-12px"):
this.config.showLabels&&d.hasClass(this.domNode,"mini-mode")&&d.setStyle(this.sliderContent,"bottom","20px")):(d.setStyle(this.btnsContainer,"margin-left","auto"),d.setStyle(this.btnsContainer,"margin-right","auto"),this.config.showLabels&&!d.hasClass(this.domNode,"mini-mode")?d.setStyle(this.sliderContent,"bottom","-20px"):this.config.showLabels&&d.hasClass(this.domNode,"mini-mode")?d.setStyle(this.sliderContent,"bottom","20px"):d.setStyle(this.sliderContent,"bottom","0px"))},_onMapResize:function(){"closed"!==
this.state&&(g.isRunInMobile()||(g.isOutOfScreen(this.map,this.position)?g.isOutOfScreen(this.map,this.position)&&g.setMarginPosition(this.map,this.domNode,this.position):g.getMarginPosition(this.map,this.domNode,this.position)),this._adaptResponsive())},destroy:function(){this.map&&this.map.setTimeExtent(null);this.inherited(arguments)},_setPlayBtnStyleTimer:function(){this._playBtnStyleTimer=setInterval(e.hitch(this,function(){this.timeSlider&&this.timeSlider.playing?d.addClass(this.playBtn,"pause"):
d.removeClass(this.playBtn,"pause")}),200)},_cleanPlayBtnStyleTimer:function(){this._playBtnStyleTimer&&clearTimeout(this._playBtnStyleTimer)},_initLayerInfosObj:function(){this._layerInfosDef||(this._layerInfosDef=new a,this.own(this._layerInfosDef),b.getInstance(this.map,this.map.itemInfo).then(e.hitch(this,function(a){this.layerInfosObj=a;this.own(l(a,"layerInfosIsShowInMapChanged",e.hitch(this,this.layerProcesser._onLayerInfosIsShowInMapChanged)));this.own(a.on("layerInfosChanged",e.hitch(this,
this.layerProcesser._onLayerInfosChanged)));this._layerInfosDef.resolve(this.layerInfosObj)})));return this._layerInfosDef},_clearMiniModeTimer:function(){d.removeClass(this.domNode,"mini-mode");this._adaptResponsive({refreshMoveable:!1});this._miniModeTimer&&clearTimeout(this._miniModeTimer)},_setMiniModeTimer:function(){var a=g.isRunInMobile()?5E3:2E3;this._miniModeTimer=setTimeout(e.hitch(this,function(){d.addClass(this.domNode,"mini-mode");this._adaptResponsive()}),a)},makeMoveable:function(a){this.disableMoveable();
var b=u.getMarginBox(this.map.root);this.moveable=new h.boxConstrainedMoveable(this.domNode,{box:b,handle:a||this.handleNode,within:!0});this.own(l(this.moveable,"MoveStart",e.hitch(this,this.onMoveStart)));this.own(l(this.moveable,"Moving",e.hitch(this,this.onMoving)));this.own(l(this.moveable,"MoveStop",e.hitch(this,this.onMoveStop)))},disableMoveable:function(){this.moveable&&(this.dragHandler=null,this.moveable.destroy(),this.moveable=null)},onMoveStart:function(a){var b=u.getMarginBox(this.map.root),
c=u.getMarginBox(this.domNode);if(window.isRTL){var e=d.getStyle(a.node,"right");d.setStyle(a.node,"left",b.w-c.w-parseInt(e,10)+"px");d.setStyle(a.node,"right","")}this._draged||(this._draged=!0)},onMoving:function(){this._moving=!0},onMoveStop:function(a){a&&a.node&&(d.setStyle(a.node,"opacity",1),a=u.getMarginBox(a.node),this.position.left=a.l,this.position.top=a.t,g.getMarginPosition(this.map,this.domNode,this.position),setTimeout(e.hitch(this,function(){this._moving=!1}),10))},_onHandleClick:function(a){a.stopPropagation()},
_initSpeedMenu:function(){this.speedMenu||(this.speedMenuNode=d.create("div",{"class":"jimu-float-trailing"},this.sliderContent),this.speedMenu=new v({nls:this.nls},this.speedMenuNode),this.speedMenuSelectedHanlder=this.own(l(this.speedMenu,"selected",e.hitch(this,function(a){this.timeSlider&&a&&(this._LAST_SPEED_RATE=a,a=parseFloat(a),this.timeSlider.setThumbMovingRate(2E3/a))}))),this.speedMenuOpenHanlder=this.own(l(this.speedMenu,"open",e.hitch(this,function(){this._clearMiniModeTimer()}))),this.speedMenuCloseHanlder=
this.own(l(this.speedMenu,"close",e.hitch(this,function(){this._setMiniModeTimer()}))),this._LAST_SPEED_RATE&&this.speedMenu.setSpeed(this._LAST_SPEED_RATE))},_destroySpeedMenu:function(){this.speedMenu&&this.speedMenu.destroy&&this.speedMenu.destroy();this.speedMenuCloseHanlder=this.speedMenuOpenHanlder=this.speedMenuSelectedHanlder=this.speedMenu=null}})});